{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { useForm, NFormItem, NFormItemRow, NForm, NButton, NInput } from 'naive-ui';\nimport { ref } from 'vue';\nimport { useRoute } from 'vue-router';\nimport axios from 'axios';\n\n//注册表单操作\n\nexport default {\n  __name: 'RegisterForm',\n  setup(__props, {\n    expose: __expose\n  }) {\n    const registerUsername = ref('');\n    const registerPassword = ref('');\n    //const registerRePassword=ref('');\n    const invitationCode = ref('');\n    const router = useRoute();\n    const registeredNextPath = ref('');\n    const register = async () => {\n      try {\n        await validate();\n        const response = axios.post('/account/register/', {\n          username: registerUsername,\n          password: registerPassword,\n          invitation_code: invitationCode\n        }, {\n          headers: {\n            //'X-CSRFToken': csrfToken.value,\n          }\n        });\n        console.log(response);\n        console.log('注册成功！');\n        await router.push(registeredNextPath.value);\n      } catch (err) {\n        console.log('注册失败:', err);\n      }\n    };\n\n    //密码验证\n    /*\n    const formRef = ref(null);\n    const rPasswordFormItemRef = ref(null);\n    const modelRef = ref({\n          password: null,\n          reenteredPassword: null\n        });\n    const model = modelRef;\n    const validatePasswordStartWith=(rule, value)=> {\n          console.log(value);\n          return !!model.value.password && model.value.password.startsWith(value) && model.value.password.length >= value.length;};\n    const validatePasswordSame=(rule, value)=> {\n          console.log(value);\n          return value === model.value.password;\n        };\n    const rules = {\n        password: [\n            {\n              required: true,\n              message: \"请输入密码\"\n            }\n          ],\n          reenteredPassword: [\n            {\n              required: true,\n              message: \"请再次输入密码\",\n              trigger: [\"input\", \"blur\"]\n            },\n            {\n              validator: validatePasswordStartWith,\n              message: \"两次密码输入不一致\",\n              trigger: \"input\"\n            },\n            {\n              validator: validatePasswordSame,\n              message: \"两次密码输入不一致\",\n              trigger: [\"blur\", \"input\"]\n            }\n          ]\n        };\n    const handlePasswordInput=()=> {\n            if (model.value.reenteredPassword) {\n              rPasswordFormItemRef.value?.validate({ trigger: \"input\" });\n            }\n          };\n    \n    */\n\n    const formRef = ref(null);\n    const rPasswordFormItemRef = ref(null);\n\n    // 响应式表单数据\n    const modelRef = ref({\n      password: '',\n      reenteredPassword: ''\n    });\n    const model = modelRef;\n\n    // 创建表单实例，并绑定模型和规则\n    const {\n      validate,\n      validateInfo\n    } = useForm({\n      model,\n      rulesRef,\n      showFeedback: true\n    });\n    const validatePasswordStartWith = (rule, value) => {\n      console.log(value);\n      return !!model.value.password && model.value.password.startsWith(value) && model.value.password.length >= value.length;\n    };\n    function validatePasswordSame(rule, value) {\n      console.log(rule);\n      console.log(value);\n      return value === model.value.password;\n    }\n    //表单验证规则\n    const rulesRef = ref({\n      password: [{\n        required: true,\n        message: \"请输入密码\"\n      }\n      // ... More rules for password here if necessary\n      ],\n      reenteredPassword: [{\n        required: true,\n        message: \"请再次输入密码\",\n        trigger: [\"input\", \"blur\"]\n      }, {\n        validator: validatePasswordStartWith,\n        message: \"两次密码输入不一致\",\n        trigger: \"input\"\n      }, {\n        validator: validatePasswordSame,\n        message: \"两次密码输入不一致\",\n        trigger: [\"blur\", \"password-input\"]\n      }]\n    });\n    const handlePasswordInput = e => {\n      console.log(e);\n      if (model.value.reenteredPassword) {\n        console.log(rPasswordFormItemRef.value);\n        rPasswordFormItemRef.value?.validate({\n          trigger: \"password-input\"\n        });\n      }\n    };\n    __expose({\n      register\n    });\n    const __returned__ = {\n      registerUsername,\n      registerPassword,\n      invitationCode,\n      router,\n      registeredNextPath,\n      register,\n      formRef,\n      rPasswordFormItemRef,\n      modelRef,\n      model,\n      validate,\n      validateInfo,\n      validatePasswordStartWith,\n      validatePasswordSame,\n      rulesRef,\n      handlePasswordInput,\n      get useForm() {\n        return useForm;\n      },\n      get NFormItem() {\n        return NFormItem;\n      },\n      get NFormItemRow() {\n        return NFormItemRow;\n      },\n      get NForm() {\n        return NForm;\n      },\n      get NButton() {\n        return NButton;\n      },\n      get NInput() {\n        return NInput;\n      },\n      ref,\n      get useRoute() {\n        return useRoute;\n      },\n      get axios() {\n        return axios;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["useForm","NFormItem","NFormItemRow","NForm","NButton","NInput","ref","useRoute","axios","registerUsername","registerPassword","invitationCode","router","registeredNextPath","register","validate","response","post","username","password","invitation_code","headers","console","log","push","value","err","formRef","rPasswordFormItemRef","modelRef","reenteredPassword","model","validateInfo","rulesRef","showFeedback","validatePasswordStartWith","rule","startsWith","length","validatePasswordSame","required","message","trigger","validator","handlePasswordInput","e","__expose"],"sources":["/Users/wangjohnson/ai_marketing/frontend/src/components/RegisterForm.vue"],"sourcesContent":["<template>\n    <n-form :ref=\"formRef\" :rules=\"rules\"  model=\"model\">\n        <n-form-item-row label=\"用户名\">\n            <n-input v-model:value=\"registerUsername\" placeholder=\"\" />\n        </n-form-item-row>\n        \n        <!--\n        <n-form-item-row label=\"密码\">\n            <n-input v-model:value=\"registerPassword\" placeholder=\"\"/>\n        </n-form-item-row>\n          \n        <n-form-item-row label=\"重复密码\">\n            //<n-input passively-activated @input=\"checkRePassword\" v-model:value=\"rePassword\" placeholder=\"\"/>\n            <n-input\n                v-model:value=\"rePassword\"\n                :disabled=\"!model.password\"\n                type=\"password\"\n                @keydown.enter.prevent/>\n        </n-form-item-row>\n         -->\n\n        <n-form-item path=\"password\" label=\"密码\">\n          <n-input\n            v-model:value=\"model.password\"\n            type=\"password\"\n            @input=\"handlePasswordInput\"\n            @keydown.enter.prevent/>\n        </n-form-item>\n    \n        <n-form-item\n          ref=\"rPasswordFormItemRef\"\n          first\n          path=\"reenteredPassword\"\n          label=\"重复密码\">\n\n          <n-input\n            v-model:value=\"model.reenteredPassword\"\n            :disabled=\"!model.password\"\n            type=\"password\"\n            @keydown.enter.prevent/>\n\n        </n-form-item>\n\n\n\n\n\n\n        <n-form-item-row label=\"邀请码\">\n            <n-input v-model:value=\"invitation_code\" placeholder=\"\"/>\n        </n-form-item-row>\n        \n    </n-form>\n    <n-button @click=\"register\" type=\"primary\" block secondary strong>\n          注册\n    </n-button>\n\n<pre>{{ JSON.stringify(model, null, 2) }}\n</pre>\n</template>\n\n\n<script setup>\nimport {useForm,NFormItem,NFormItemRow,NForm,NButton,NInput} from 'naive-ui';\nimport {ref,defineExpose} from 'vue';\nimport {useRoute} from 'vue-router';\nimport axios from 'axios';\n\n//注册表单操作\nconst registerUsername=ref('');\nconst registerPassword=ref('');\n//const registerRePassword=ref('');\nconst invitationCode = ref('');\nconst router=useRoute();\nconst registeredNextPath = ref('');\n\nconst register=async()=>{\n    try{\n      await validate();\n      const response = axios.post('/account/register/',\n      {\n        username:registerUsername,\n        password:registerPassword,\n        invitation_code:invitationCode,\n        },\n      {\n            headers:{\n                //'X-CSRFToken': csrfToken.value,\n                }\n      });\n      console.log(response);\n      console.log('注册成功！');\n      await router.push(registeredNextPath.value);\n    }\n    catch(err){\n        console.log('注册失败:',err)}\n    \n }\n\n//密码验证\n/*\nconst formRef = ref(null);\nconst rPasswordFormItemRef = ref(null);\nconst modelRef = ref({\n      password: null,\n      reenteredPassword: null\n    });\nconst model = modelRef;\nconst validatePasswordStartWith=(rule, value)=> {\n      console.log(value);\n      return !!model.value.password && model.value.password.startsWith(value) && model.value.password.length >= value.length;};\nconst validatePasswordSame=(rule, value)=> {\n      console.log(value);\n      return value === model.value.password;\n    };\nconst rules = {\n    password: [\n        {\n          required: true,\n          message: \"请输入密码\"\n        }\n      ],\n      reenteredPassword: [\n        {\n          required: true,\n          message: \"请再次输入密码\",\n          trigger: [\"input\", \"blur\"]\n        },\n        {\n          validator: validatePasswordStartWith,\n          message: \"两次密码输入不一致\",\n          trigger: \"input\"\n        },\n        {\n          validator: validatePasswordSame,\n          message: \"两次密码输入不一致\",\n          trigger: [\"blur\", \"input\"]\n        }\n      ]\n    };\nconst handlePasswordInput=()=> {\n        if (model.value.reenteredPassword) {\n          rPasswordFormItemRef.value?.validate({ trigger: \"input\" });\n        }\n      };\n\n*/\n\nconst formRef = ref(null);\nconst rPasswordFormItemRef = ref(null);\n\n// 响应式表单数据\nconst modelRef = ref({\n  password: '',\n  reenteredPassword: '',\n});\nconst model=modelRef;\n\n// 创建表单实例，并绑定模型和规则\nconst {validate,validateInfo} = useForm({\n    model,\n    rulesRef,\n    showFeedback:true});\n\nconst validatePasswordStartWith=(rule, value)=> {\n    console.log(value);\n  return !!model.value.password && model.value.password.startsWith(value) && model.value.password.length >= value.length;\n}\n\nfunction validatePasswordSame(rule, value) {\n  console.log(rule);\n  console.log(value);\n  return value === model.value.password;\n}\n//表单验证规则\nconst rulesRef = ref({\n  password: [\n    {\n      required: true,\n      message: \"请输入密码\"\n    }\n    // ... More rules for password here if necessary\n  ],\n  reenteredPassword: [\n    {\n      required: true,\n      message: \"请再次输入密码\",\n      trigger: [\"input\", \"blur\"]\n    },\n    {\n      validator: validatePasswordStartWith,\n      message: \"两次密码输入不一致\",\n      trigger: \"input\"\n    },\n    {\n      validator: validatePasswordSame,\n      message: \"两次密码输入不一致\",\n      trigger: [\"blur\", \"password-input\"]\n    }\n  ]\n});\n\nconst handlePasswordInput=(e)=> {\n    console.log(e);\n  if (model.value.reenteredPassword) {\n      console.log(rPasswordFormItemRef.value);\n    rPasswordFormItemRef.value?.validate({ trigger: \"password-input\" });\n  }\n}\n\n\ndefineExpose({register});\n</script>\n\n<style>\n.n-input{\n    text-align:left}\n</style>\n"],"mappings":";AA+DA,SAAQA,OAAO,EAACC,SAAS,EAACC,YAAY,EAACC,KAAK,EAACC,OAAO,EAACC,MAAM,QAAO,UAAU;AAC5E,SAAQC,GAAgB,QAAO,KAAK;AACpC,SAAQC,QAAQ,QAAO,YAAY;AACnC,OAAOC,KAAK,MAAM,OAAO;;AAEzB;;;;;;;IACA,MAAMC,gBAAgB,GAACH,GAAG,CAAC,EAAE,CAAC;IAC9B,MAAMI,gBAAgB,GAACJ,GAAG,CAAC,EAAE,CAAC;IAC9B;IACA,MAAMK,cAAc,GAAGL,GAAG,CAAC,EAAE,CAAC;IAC9B,MAAMM,MAAM,GAACL,QAAQ,CAAC,CAAC;IACvB,MAAMM,kBAAkB,GAAGP,GAAG,CAAC,EAAE,CAAC;IAElC,MAAMQ,QAAQ,GAAC,MAAAA,CAAA,KAAS;MACpB,IAAG;QACD,MAAMC,QAAQ,CAAC,CAAC;QAChB,MAAMC,QAAQ,GAAGR,KAAK,CAACS,IAAI,CAAC,oBAAoB,EAChD;UACEC,QAAQ,EAACT,gBAAgB;UACzBU,QAAQ,EAACT,gBAAgB;UACzBU,eAAe,EAACT;QAChB,CAAC,EACH;UACMU,OAAO,EAAC;YACJ;UAAA;QAEV,CAAC,CAAC;QACFC,OAAO,CAACC,GAAG,CAACP,QAAQ,CAAC;QACrBM,OAAO,CAACC,GAAG,CAAC,OAAO,CAAC;QACpB,MAAMX,MAAM,CAACY,IAAI,CAACX,kBAAkB,CAACY,KAAK,CAAC;MAC7C,CAAC,CACD,OAAMC,GAAG,EAAC;QACNJ,OAAO,CAACC,GAAG,CAAC,OAAO,EAACG,GAAG,CAAC;MAAA;IAE/B,CAAC;;IAEF;IACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;IAEA,MAAMC,OAAO,GAAGrB,GAAG,CAAC,IAAI,CAAC;IACzB,MAAMsB,oBAAoB,GAAGtB,GAAG,CAAC,IAAI,CAAC;;IAEtC;IACA,MAAMuB,QAAQ,GAAGvB,GAAG,CAAC;MACnBa,QAAQ,EAAE,EAAE;MACZW,iBAAiB,EAAE;IACrB,CAAC,CAAC;IACF,MAAMC,KAAK,GAACF,QAAQ;;IAEpB;IACA,MAAM;MAACd,QAAQ;MAACiB;IAAY,CAAC,GAAGhC,OAAO,CAAC;MACpC+B,KAAK;MACLE,QAAQ;MACRC,YAAY,EAAC;IAAI,CAAC,CAAC;IAEvB,MAAMC,yBAAyB,GAACA,CAACC,IAAI,EAAEX,KAAK,KAAI;MAC5CH,OAAO,CAACC,GAAG,CAACE,KAAK,CAAC;MACpB,OAAO,CAAC,CAACM,KAAK,CAACN,KAAK,CAACN,QAAQ,IAAIY,KAAK,CAACN,KAAK,CAACN,QAAQ,CAACkB,UAAU,CAACZ,KAAK,CAAC,IAAIM,KAAK,CAACN,KAAK,CAACN,QAAQ,CAACmB,MAAM,IAAIb,KAAK,CAACa,MAAM;IACxH,CAAC;IAED,SAASC,oBAAoBA,CAACH,IAAI,EAAEX,KAAK,EAAE;MACzCH,OAAO,CAACC,GAAG,CAACa,IAAI,CAAC;MACjBd,OAAO,CAACC,GAAG,CAACE,KAAK,CAAC;MAClB,OAAOA,KAAK,KAAKM,KAAK,CAACN,KAAK,CAACN,QAAQ;IACvC;IACA;IACA,MAAMc,QAAQ,GAAG3B,GAAG,CAAC;MACnBa,QAAQ,EAAE,CACR;QACEqB,QAAQ,EAAE,IAAI;QACdC,OAAO,EAAE;MACX;MACA;MAAA,CACD;MACDX,iBAAiB,EAAE,CACjB;QACEU,QAAQ,EAAE,IAAI;QACdC,OAAO,EAAE,SAAS;QAClBC,OAAO,EAAE,CAAC,OAAO,EAAE,MAAM;MAC3B,CAAC,EACD;QACEC,SAAS,EAAER,yBAAyB;QACpCM,OAAO,EAAE,WAAW;QACpBC,OAAO,EAAE;MACX,CAAC,EACD;QACEC,SAAS,EAAEJ,oBAAoB;QAC/BE,OAAO,EAAE,WAAW;QACpBC,OAAO,EAAE,CAAC,MAAM,EAAE,gBAAgB;MACpC,CAAC;IAEL,CAAC,CAAC;IAEF,MAAME,mBAAmB,GAAEC,CAAC,IAAI;MAC5BvB,OAAO,CAACC,GAAG,CAACsB,CAAC,CAAC;MAChB,IAAId,KAAK,CAACN,KAAK,CAACK,iBAAiB,EAAE;QAC/BR,OAAO,CAACC,GAAG,CAACK,oBAAoB,CAACH,KAAK,CAAC;QACzCG,oBAAoB,CAACH,KAAK,EAAEV,QAAQ,CAAC;UAAE2B,OAAO,EAAE;QAAiB,CAAC,CAAC;MACrE;IACF,CAAC;IAGDI,QAAY,CAAC;MAAChC;IAAQ,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}