{"ast":null,"code":"import { createVNode as _createVNode, createCommentVNode as _createCommentVNode, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock } from \"vue\";\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createBlock($setup[\"NTabs\"], {\n    class: \"card-tabs\",\n    \"default-value\": \"login\",\n    size: \"large\",\n    animated: \"\",\n    \"pane-wrapper-style\": \"margin: 0 -4px\",\n    \"pane-style\": \"padding-left: 4px; padding-right: 4px; box-sizing: border-box;\"\n  }, {\n    default: _withCtx(() => [_createVNode($setup[\"NTabPane\"], {\n      name: \"login\",\n      tab: \"登录\"\n    }, {\n      default: _withCtx(() => [_createVNode($setup[\"LoginForm\"]), _createCommentVNode(\"\\n        <n-form>\\n          <n-form-item-row label=\\\"用户名\\\">\\n            <n-input v-model:value=\\\"loginUsername\\\" placeholder=\\\"\\\"/>\\n          </n-form-item-row>\\n          <n-form-item-row label=\\\"密码\\\">\\n            <n-input v-model:value=\\\"loginPassword\\\" placeholder=\\\"最长15位字符\\\" type=\\\"password\\\" show-password-on=\\\"click\\\" :maxlength=\\\"15\\\"/>\\n          </n-form-item-row>\\n        </n-form>\\n        <n-button @click=\\\"login\\\" type=\\\"primary\\\" block secondary strong>\\n          登录\\n        </n-button>\\n        \")]),\n      _: 1 /* STABLE */\n    }), _createVNode($setup[\"NTabPane\"], {\n      name: \"register\",\n      tab: \"注册\"\n    }, {\n      default: _withCtx(() => [_createVNode($setup[\"RegisterForm\"]), _createCommentVNode(\"\\n        <n-form>\\n          <n-form-item-row label=\\\"用户名\\\">\\n            <n-input v-model:value=\\\"registerUsername\\\" placeholder=\\\"\\\" />\\n          </n-form-item-row>\\n          <n-form-item-row label=\\\"密码\\\">\\n            <n-input v-model:value=\\\"registerPassword\\\" :maxlength=\\\"15\\\" placeholder=\\\"最长15位字符\\\"/>\\n          </n-form-item-row>\\n          <n-form-item-row label=\\\"重复密码\\\">\\n            <n-input v-model:value=\\\"registerRePassword\\\" placeholder=\\\"\\\"/>\\n          </n-form-item-row>\\n          <n-form-item-row label=\\\"邀请码\\\">\\n            <n-input v-model:value=\\\"invitation_code\\\" placeholder=\\\"\\\"/>\\n          </n-form-item-row>\\n        </n-form>\\n        <n-button @click=\\\"register\\\" type=\\\"primary\\\" block secondary strong>\\n          注册\\n        </n-button>\\n        \")]),\n      _: 1 /* STABLE */\n    })]),\n    _: 1 /* STABLE */\n  });\n}","map":{"version":3,"names":["_createBlock","$setup","class","size","animated","default","_withCtx","_createVNode","name","tab","_createCommentVNode","_"],"sources":["/Users/wangjohnson/ai_marketing/frontend/src/components/LoginRegister.vue"],"sourcesContent":["<template>\n\n    <n-tabs\n      class=\"card-tabs\"\n      default-value=\"login\"\n      size=\"large\"\n      animated\n      pane-wrapper-style=\"margin: 0 -4px\"\n      pane-style=\"padding-left: 4px; padding-right: 4px; box-sizing: border-box;\"\n    >\n\n      <n-tab-pane name=\"login\" tab=\"登录\">\n            <login-form/>\n       <!--\n        <n-form>\n          <n-form-item-row label=\"用户名\">\n            <n-input v-model:value=\"loginUsername\" placeholder=\"\"/>\n          </n-form-item-row>\n          <n-form-item-row label=\"密码\">\n            <n-input v-model:value=\"loginPassword\" placeholder=\"最长15位字符\" type=\"password\" show-password-on=\"click\" :maxlength=\"15\"/>\n          </n-form-item-row>\n        </n-form>\n        <n-button @click=\"login\" type=\"primary\" block secondary strong>\n          登录\n        </n-button>\n        -->\n      </n-tab-pane>\n\n      <n-tab-pane name=\"register\" tab=\"注册\">\n        <register-form/>\n        \n\n        <!--\n        <n-form>\n          <n-form-item-row label=\"用户名\">\n            <n-input v-model:value=\"registerUsername\" placeholder=\"\" />\n          </n-form-item-row>\n          <n-form-item-row label=\"密码\">\n            <n-input v-model:value=\"registerPassword\" :maxlength=\"15\" placeholder=\"最长15位字符\"/>\n          </n-form-item-row>\n          <n-form-item-row label=\"重复密码\">\n            <n-input v-model:value=\"registerRePassword\" placeholder=\"\"/>\n          </n-form-item-row>\n          <n-form-item-row label=\"邀请码\">\n            <n-input v-model:value=\"invitation_code\" placeholder=\"\"/>\n          </n-form-item-row>\n        </n-form>\n        <n-button @click=\"register\" type=\"primary\" block secondary strong>\n          注册\n        </n-button>\n        -->\n      </n-tab-pane>\n    </n-tabs>\n \n</template>\n\n<script setup>\nimport {NTabs,NTabPane} from 'naive-ui'\nimport {ref,defineExpose} from 'vue';\nimport {useStore} from 'vuex';\nimport {useRouter} from 'vue-router';\nimport axios from 'axios';\nimport RegisterForm from './RegisterForm.vue';\nimport LoginForm from './LoginForm.vue';\n\n\n//通用变量\nconst authStore = useStore();\nconst router = useRouter();\n\n//登录表单操作\nconst loginUsername = ref('');\nconst loginPassword = ref('');\nconst keepLoggedInForDays = ref('7'); // 默认设置为7天，通过select控件让用户可选择\n\nconst login = async () => {\n    try{\n        const response = await axios.post('/account/login/', \n        {   \n          username: loginUsername.value,\n          password: loginPassword.value,\n          keep_logged_in_for_days: keepLoggedInForDays.value\n        },  \n        {   \n          withCredentials: true,\n          headers: {\n            //先注销'X-CSRFToken': csrfToken.value,\n          }   \n        });\n        const token = response.data.token.access;\n        const user = response.data.username;\n        const csrf_token = response.data.csrf_token;\n        console.log('csrf_token:',csrf_token);\n        localStorage.setItem('token', token);\n        await authStore.commit('auth_success', { token, user });\n        console.log(\"登录成功：\",loginUsername.value); \n        await router.push('/dashboard');\n        \n        }catch(err){\n            console.log(\"登录失败：\",err)\n        }\n    }\n\n\n\n//暴露方法\ndefineExpose({login});\n</script>\n\n<style>\n.n-input{\n    text-align:left}\n</style>\n\n"],"mappings":";;uBAEIA,YAAA,CAkDSC,MAAA;IAjDPC,KAAK,EAAC,WAAW;IACjB,eAAa,EAAC,OAAO;IACrBC,IAAI,EAAC,OAAO;IACZC,QAAQ,EAAR,EAAQ;IACR,oBAAkB,EAAC,gBAAgB;IACnC,YAAU,EAAC;;IARjBC,OAAA,EAAAC,QAAA,CAWM,MAea,CAfbC,YAAA,CAeaN,MAAA;MAfDO,IAAI,EAAC,OAAO;MAACC,GAAG,EAAC;;MAXnCJ,OAAA,EAAAC,QAAA,CAYY,MAAa,CAAbC,YAAA,CAAaN,MAAA,gBAClBS,mBAAA,4gBAYI,C;MAzBXC,CAAA;QA4BMJ,YAAA,CAuBaN,MAAA;MAvBDO,IAAI,EAAC,UAAU;MAACC,GAAG,EAAC;;MA5BtCJ,OAAA,EAAAC,QAAA,CA6BQ,MAAgB,CAAhBC,YAAA,CAAgBN,MAAA,mBAGhBS,mBAAA,qxBAkBG,C;MAlDXC,CAAA;;IAAAA,CAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}