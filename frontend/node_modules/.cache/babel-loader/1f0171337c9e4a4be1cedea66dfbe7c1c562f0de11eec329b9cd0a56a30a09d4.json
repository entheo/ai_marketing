{"ast":null,"code":"import { createVNode as _createVNode, withCtx as _withCtx, createTextVNode as _createTextVNode, openBlock as _openBlock, createBlock as _createBlock } from \"vue\";\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createBlock($setup[\"NCard\"], null, {\n    default: _withCtx(() => [_createVNode($setup[\"NTabs\"], {\n      class: \"card-tabs\",\n      \"default-value\": \"signin\",\n      size: \"large\",\n      animated: \"\",\n      \"pane-wrapper-style\": \"margin: 0 -4px\",\n      \"pane-style\": \"padding-left: 4px; padding-right: 4px; box-sizing: border-box;\"\n    }, {\n      default: _withCtx(() => [_createVNode($setup[\"NTabPane\"], {\n        name: \"signin\",\n        tab: \"登录\"\n      }, {\n        default: _withCtx(() => [_createVNode($setup[\"NForm\"], null, {\n          default: _withCtx(() => [_createVNode($setup[\"NFormItemRow\"], {\n            label: \"用户名\"\n          }, {\n            default: _withCtx(() => [_createVNode($setup[\"NInput\"])]),\n            _: 1 /* STABLE */\n          }), _createVNode($setup[\"NFormItemRow\"], {\n            label: \"密码\"\n          }, {\n            default: _withCtx(() => [_createVNode($setup[\"NInput\"])]),\n            _: 1 /* STABLE */\n          })]),\n          _: 1 /* STABLE */\n        }), _createVNode($setup[\"NButton\"], {\n          onClick: $setup.login,\n          type: \"primary\",\n          block: \"\",\n          secondary: \"\",\n          strong: \"\"\n        }, {\n          default: _withCtx(() => [_createTextVNode(\" 登录 \")]),\n          _: 1 /* STABLE */\n        })]),\n        _: 1 /* STABLE */\n      }), _createVNode($setup[\"NTabPane\"], {\n        name: \"signup\",\n        tab: \"注册\"\n      }, {\n        default: _withCtx(() => [_createVNode($setup[\"NForm\"], null, {\n          default: _withCtx(() => [_createVNode($setup[\"NFormItemRow\"], {\n            label: \"用户名\"\n          }, {\n            default: _withCtx(() => [_createVNode($setup[\"NInput\"])]),\n            _: 1 /* STABLE */\n          }), _createVNode($setup[\"NFormItemRow\"], {\n            label: \"密码\"\n          }, {\n            default: _withCtx(() => [_createVNode($setup[\"NInput\"])]),\n            _: 1 /* STABLE */\n          }), _createVNode($setup[\"NFormItemRow\"], {\n            label: \"重复密码\"\n          }, {\n            default: _withCtx(() => [_createVNode($setup[\"NInput\"])]),\n            _: 1 /* STABLE */\n          })]),\n          _: 1 /* STABLE */\n        }), _createVNode($setup[\"NButton\"], {\n          onClick: _ctx.register,\n          type: \"primary\",\n          block: \"\",\n          secondary: \"\",\n          strong: \"\"\n        }, {\n          default: _withCtx(() => [_createTextVNode(\" 注册 \")]),\n          _: 1 /* STABLE */\n        }, 8 /* PROPS */, [\"onClick\"])]),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    })]),\n    _: 1 /* STABLE */\n  });\n}","map":{"version":3,"names":["_createBlock","$setup","default","_withCtx","_createVNode","class","size","animated","name","tab","label","_","onClick","login","type","block","secondary","strong","_createTextVNode","_ctx","register"],"sources":["/Users/wangjohnson/ai_marketing/frontend/src/components/LoginForm.vue"],"sourcesContent":["<template>\n<n-card>\n    <n-tabs\n      class=\"card-tabs\"\n      default-value=\"signin\"\n      size=\"large\"\n      animated\n      pane-wrapper-style=\"margin: 0 -4px\"\n      pane-style=\"padding-left: 4px; padding-right: 4px; box-sizing: border-box;\"\n    >\n      <n-tab-pane name=\"signin\" tab=\"登录\">\n        <n-form>\n          <n-form-item-row label=\"用户名\">\n            <n-input />\n          </n-form-item-row>\n          <n-form-item-row label=\"密码\">\n            <n-input />\n          </n-form-item-row>\n        </n-form>\n        <n-button @click=\"login\" type=\"primary\" block secondary strong>\n          登录\n        </n-button>\n      </n-tab-pane>\n      <n-tab-pane name=\"signup\" tab=\"注册\">\n        <n-form>\n          <n-form-item-row label=\"用户名\">\n            <n-input />\n          </n-form-item-row>\n          <n-form-item-row label=\"密码\">\n            <n-input />\n          </n-form-item-row>\n          <n-form-item-row label=\"重复密码\">\n            <n-input />\n          </n-form-item-row>\n        </n-form>\n        <n-button @click=\"register\" type=\"primary\" block secondary strong>\n          注册\n        </n-button>\n      </n-tab-pane>\n    </n-tabs>\n  </n-card>\n</template>\n\n<script setup>\nimport {NButton,NInput,NForm,NFormItemRow,NCard,NTabs,NTabPane} from 'naive-ui'\nimport {ref,defineExpose} from 'vue';\nimport {useStore} from 'vuex';\nimport {useRouter} from 'vue-router';\nimport axios from 'axios';\n\n\n//通用变量\nconst authStore = useStore();\nconst router = useRouter();\n\n//登录表单操作\nconst loginUsername = ref('');\nconst loginPassword = ref('');\nconst keepLoggedInForDays = ref('7'); // 默认设置为7天，通过select控件让用户可选择\n\nconst login = async () => {\n    try{\n        const response = await axios.post('/account/login/', \n        {   \n          username: loginUsername.value,\n          password: loginPassword.value,\n          keep_logged_in_for_days: keepLoggedInForDays.value\n        },  \n        {   \n          withCredentials: true,\n          headers: {\n            //先注销'X-CSRFToken': csrfToken.value,\n          }   \n        });\n        const token = response.data.token.access;\n        const user = response.data.username;\n        const csrf_token = response.data.csrf_token;\n        console.log('csrf_token:',csrf_token);\n        localStorage.setItem('token', token);\n        await authStore.commit('auth_success', { token, user });\n        console.log(\"登录成功：\",loginUsername.value); \n        await router.push('/dashboard');\n        \n        }catch(err){\n            console.log(\"登录失败：\",err)}\n\n    }\n\n\n\n\n//暴露方法\ndefineExpose({login});\n</script>\n\n"],"mappings":";;uBACAA,YAAA,CAuCWC,MAAA;IAxCXC,OAAA,EAAAC,QAAA,CAEI,MAqCS,CArCTC,YAAA,CAqCSH,MAAA;MApCPI,KAAK,EAAC,WAAW;MACjB,eAAa,EAAC,QAAQ;MACtBC,IAAI,EAAC,OAAO;MACZC,QAAQ,EAAR,EAAQ;MACR,oBAAkB,EAAC,gBAAgB;MACnC,YAAU,EAAC;;MARjBL,OAAA,EAAAC,QAAA,CAUM,MAYa,CAZbC,YAAA,CAYaH,MAAA;QAZDO,IAAI,EAAC,QAAQ;QAACC,GAAG,EAAC;;QAVpCP,OAAA,EAAAC,QAAA,CAWQ,MAOS,CAPTC,YAAA,CAOSH,MAAA;UAlBjBC,OAAA,EAAAC,QAAA,CAYU,MAEkB,CAFlBC,YAAA,CAEkBH,MAAA;YAFDS,KAAK,EAAC;UAAK;YAZtCR,OAAA,EAAAC,QAAA,CAaY,MAAW,CAAXC,YAAA,CAAWH,MAAA,Y;YAbvBU,CAAA;cAeUP,YAAA,CAEkBH,MAAA;YAFDS,KAAK,EAAC;UAAI;YAfrCR,OAAA,EAAAC,QAAA,CAgBY,MAAW,CAAXC,YAAA,CAAWH,MAAA,Y;YAhBvBU,CAAA;;UAAAA,CAAA;YAmBQP,YAAA,CAEWH,MAAA;UAFAW,OAAK,EAAEX,MAAA,CAAAY,KAAK;UAAEC,IAAI,EAAC,SAAS;UAACC,KAAK,EAAL,EAAK;UAACC,SAAS,EAAT,EAAS;UAACC,MAAM,EAAN;;UAnBhEf,OAAA,EAAAC,QAAA,CAmBuE,MAE/D,CArBRe,gBAAA,CAmBuE,MAE/D,E;UArBRP,CAAA;;QAAAA,CAAA;UAuBMP,YAAA,CAeaH,MAAA;QAfDO,IAAI,EAAC,QAAQ;QAACC,GAAG,EAAC;;QAvBpCP,OAAA,EAAAC,QAAA,CAwBQ,MAUS,CAVTC,YAAA,CAUSH,MAAA;UAlCjBC,OAAA,EAAAC,QAAA,CAyBU,MAEkB,CAFlBC,YAAA,CAEkBH,MAAA;YAFDS,KAAK,EAAC;UAAK;YAzBtCR,OAAA,EAAAC,QAAA,CA0BY,MAAW,CAAXC,YAAA,CAAWH,MAAA,Y;YA1BvBU,CAAA;cA4BUP,YAAA,CAEkBH,MAAA;YAFDS,KAAK,EAAC;UAAI;YA5BrCR,OAAA,EAAAC,QAAA,CA6BY,MAAW,CAAXC,YAAA,CAAWH,MAAA,Y;YA7BvBU,CAAA;cA+BUP,YAAA,CAEkBH,MAAA;YAFDS,KAAK,EAAC;UAAM;YA/BvCR,OAAA,EAAAC,QAAA,CAgCY,MAAW,CAAXC,YAAA,CAAWH,MAAA,Y;YAhCvBU,CAAA;;UAAAA,CAAA;YAmCQP,YAAA,CAEWH,MAAA;UAFAW,OAAK,EAAEO,IAAA,CAAAC,QAAQ;UAAEN,IAAI,EAAC,SAAS;UAACC,KAAK,EAAL,EAAK;UAACC,SAAS,EAAT,EAAS;UAACC,MAAM,EAAN;;UAnCnEf,OAAA,EAAAC,QAAA,CAmC0E,MAElE,CArCRe,gBAAA,CAmC0E,MAElE,E;UArCRP,CAAA;;QAAAA,CAAA;;MAAAA,CAAA;;IAAAA,CAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}