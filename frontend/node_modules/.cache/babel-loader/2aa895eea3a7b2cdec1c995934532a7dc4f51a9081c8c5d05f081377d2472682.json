{"ast":null,"code":"import { ref } from 'vue';\nimport axios from 'axios';\n//import { MdArrowRoundBack, MdArrowRoundForward } from '@vicons/ionicons4';\nimport { NFlex, NCard, NStep, NSpace, NButton, NSteps } from 'naive-ui';\nimport CreateCampaignForm from './CreateCampaignForm.vue';\nimport CreatePersonaForm from './CreatePersonaForm.vue';\nimport CreateProductForm from './CreateProductForm.vue';\nimport CreateSenarioForm from './CreateSenarioForm.vue';\nexport default {\n  __name: 'GuidePage',\n  props: {\n    modifyMode: Boolean\n  },\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const getCsrfToken = () => {\n      return document.cookie.split('; ').find(row => row.startsWith('csrftoken'))?.split('=')[1];\n    };\n    const props = __props;\n    const formData = ref({\n      campaignData: null,\n      personaData: null,\n      productData: null,\n      senarioData: null\n    });\n    const currentRef = ref(1);\n    const currentStatus = ref('process');\n    const current = currentRef;\n    const next = () => {\n      console.log(currentRef.value);\n      if (currentRef.value === null) currentRef.value = 1;else if (currentRef.value >= 4) currentRef.value = 4;else currentRef.value++;\n      console.log(currentRef.value);\n    };\n    const prev = () => {\n      console.log(currentRef.value);\n      if (currentRef.value === 0) currentRef.value = null;else if (currentRef.value === null) currentRef.value = 4;else currentRef.value--;\n      if (currentRef.value < 1) currentRef.value = 1;\n      console.log(currentRef.value);\n    };\n    const campaignForm = ref(null);\n    const saveCampaignForm = () => {\n      campaignForm.value.createCampaign();\n    };\n    const updateCampaignData = message => {\n      console.log('Update Campaign');\n      formData.value.campaignData = message;\n      console.log(formData);\n      console.log(props.modifyMode);\n      next();\n    };\n    const personaForm = ref(null);\n    const savePersonaForm = () => {\n      personaForm.value.createPersona();\n    };\n    const updatePersonaData = message => {\n      console.log('Update Persona');\n      formData.value.personaData = message;\n      console.log(formData);\n      next();\n    };\n    const productForm = ref(null);\n    const saveProductForm = () => {\n      productForm.value.createProduct();\n    };\n    const updateProductData = message => {\n      console.log('Update Product');\n      formData.value.productData = message;\n      console.log(formData);\n      next();\n    };\n    const senarioForm = ref(null);\n    const submitGuideForm = async () => {\n      const token = localStorage.getItem('token');\n      const csrfToken = ref(getCsrfToken());\n      senarioForm.value.createSenario();\n      console.log('最终表单');\n      console.log(formData);\n      try {\n        const resp = await axios.post('/api/assistant/', formData, {\n          headers: {\n            'Authorization': `Bearer ${token}`,\n            // 设置请求头\n            'X-CSRFToken': csrfToken.value\n          },\n          withCredentials: true\n        });\n        console.log(resp);\n      } catch (error) {\n        console.error('Failed to get info:', error);\n      }\n    };\n    const updateSenarioData = message => {\n      console.log('Update Senario');\n      formData.value.senarioData = message;\n      console.log(formData);\n    };\n    const __returned__ = {\n      getCsrfToken,\n      props,\n      formData,\n      currentRef,\n      currentStatus,\n      current,\n      next,\n      prev,\n      campaignForm,\n      saveCampaignForm,\n      updateCampaignData,\n      personaForm,\n      savePersonaForm,\n      updatePersonaData,\n      productForm,\n      saveProductForm,\n      updateProductData,\n      senarioForm,\n      submitGuideForm,\n      updateSenarioData,\n      ref,\n      get axios() {\n        return axios;\n      },\n      get NFlex() {\n        return NFlex;\n      },\n      get NCard() {\n        return NCard;\n      },\n      get NStep() {\n        return NStep;\n      },\n      get NSpace() {\n        return NSpace;\n      },\n      get NButton() {\n        return NButton;\n      },\n      get NSteps() {\n        return NSteps;\n      },\n      CreateCampaignForm,\n      CreatePersonaForm,\n      CreateProductForm,\n      CreateSenarioForm\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","axios","NFlex","NCard","NStep","NSpace","NButton","NSteps","CreateCampaignForm","CreatePersonaForm","CreateProductForm","CreateSenarioForm","getCsrfToken","document","cookie","split","find","row","startsWith","props","__props","formData","campaignData","personaData","productData","senarioData","currentRef","currentStatus","current","next","console","log","value","prev","campaignForm","saveCampaignForm","createCampaign","updateCampaignData","message","modifyMode","personaForm","savePersonaForm","createPersona","updatePersonaData","productForm","saveProductForm","createProduct","updateProductData","senarioForm","submitGuideForm","token","localStorage","getItem","csrfToken","createSenario","resp","post","headers","withCredentials","error","updateSenarioData"],"sources":["/Users/wangjohnson/ai_marketing/frontend/src/components/GuidePage.vue"],"sourcesContent":["<template>\n  <n-space vertical>\n    <n-steps :current=\"Number(current)\" :status=\"currentStatus\">\n      <n-step\n        title=\"营销目标\"\n        description=\"设定清晰的营销目标是成功的第一步,要尽力确保营销工作的重要环节都能做到有的放矢\"\n      >\n      \n      </n-step>\n      <n-step\n        title=\"客户画像\"\n        description=\"勾勒目标客户画像可以更精准地定位市场，并制定出能够引起目标客户共鸣的营销信息\"\n      />\n      <n-step\n        title=\"产品描述\"\n        description=\"好的产品描述能够激发潜在客户的购买欲望，并建立产品与客户之间的情感联系\"\n      />\n      <n-step\n        title=\"场景&情绪\"\n        description=\"营造恰当的场景情绪可以极大地影响客户的感知和行为，促使目标客户采取行动\"\n      />\n    </n-steps>\n    <!--\n    <n-space>\n      <n-button-group>\n        <n-button @click=\"prev\">\n          <template #icon>\n            <n-icon>\n              <md-arrow-round-back />\n            </n-icon>\n          </template>\n        </n-button>\n        <n-button @click=\"next\">\n          <template #icon>\n            <n-icon>\n              <md-arrow-round-forward />\n            </n-icon>\n          </template>\n        </n-button>\n      </n-button-group>\n      <n-radio-group v-model:value=\"currentStatus\" size=\"medium\" name=\"basic\">\n        <n-radio-button value=\"error\">\n          Error\n        </n-radio-button>\n        <n-radio-button value=\"process\">\n          Process\n        </n-radio-button>\n        <n-radio-button value=\"wait\">\n          Wait\n        </n-radio-button>\n        <n-radio-button value=\"finish\">\n          Finish\n        </n-radio-button>\n      </n-radio-group>\n    </n-space>\n  -->\n</n-space>\n\n<n-card :bordered=\"false\" v-show=\"currentRef==1\">\n<create-campaign-form @createdCampaignInfo=\"updateCampaignData\" ref=\"campaignForm\"/>\n<n-flex justify=\"center\">\n  <n-button type=\"info\" @click=\"saveCampaignForm\">保存并下一步</n-button>\n</n-flex>\n</n-card>\n\n<n-card :bordered=\"false\" v-show=\"currentRef==2\">\n<create-persona-form @createdPersonaInfo = \"updatePersonaData\" ref=\"personaForm\"/>\n<n-flex justify=\"center\">\n<n-button @click=\"prev\">上一步</n-button>\n<n-button type=\"info\" @click=\"savePersonaForm\">保存并下一步</n-button>\n</n-flex>\n</n-card>\n\n<n-card :bordered=\"false\" v-show=\"currentRef==3\">\n<create-product-form @createdProductInfo = \"updateProductData\" ref=\"productForm\"/>\n<n-flex justify=\"center\">\n<n-button @click=\"prev\">上一步</n-button>\n<n-button type=\"info\" @click=\"saveProductForm\">保存并下一步</n-button>\n</n-flex>\n</n-card>\n\n<n-card :bordered=\"false\" v-show=\"currentRef==4\">\n<create-senario-form @senarioInfoCreated=\"updateSenarioData\" ref=\"senarioForm\"/>\n<n-flex justfiy=\"center\">\n<n-button @click=\"prev\">上一步</n-button>\n<n-button type=\"primary\" @click=\"submitGuideForm\">保存并提交</n-button>\n</n-flex>\n</n-card>\n\n\n</template>\n\n<script setup>\nimport {ref,defineProps} from 'vue';\nimport axios from 'axios';\n//import { MdArrowRoundBack, MdArrowRoundForward } from '@vicons/ionicons4';\nimport { NFlex, NCard,  NStep, NSpace, NButton,NSteps} from 'naive-ui';\nimport CreateCampaignForm from './CreateCampaignForm.vue';\nimport CreatePersonaForm from './CreatePersonaForm.vue';\nimport CreateProductForm from './CreateProductForm.vue';\nimport CreateSenarioForm from './CreateSenarioForm.vue';\n\n\nconst getCsrfToken = () => {\n  return document.cookie.split('; ')\n    .find(row => row.startsWith('csrftoken'))\n    ?.split('=')[1];\n};\n\nconst props = defineProps({\n    modifyMode:Boolean\n    });\n\nconst formData = ref({\n    campaignData:null,\n    personaData:null,\n    productData:null,\n    senarioData:null\n    });\nconst currentRef = ref(1);\nconst currentStatus = ref('process');\nconst current = currentRef;\nconst next = () => {\n  console.log(currentRef.value);\n  if (currentRef.value === null)\n    currentRef.value = 1;\n  else if (currentRef.value >= 4)\n    currentRef.value =4 ;\n  else\n    currentRef.value++;\n console.log(currentRef.value);\n}\n\nconst prev = () => {\n  console.log(currentRef.value);\n  if (currentRef.value === 0)\n    currentRef.value = null ;\n  else if (currentRef.value === null)\n    currentRef.value = 4;\n  else\n    currentRef.value--;\n    if (currentRef.value <1)\n        currentRef.value =1;\n  console.log(currentRef.value);\n};\n\nconst campaignForm = ref(null);\nconst saveCampaignForm = () =>{\n    campaignForm.value.createCampaign();   \n    }\nconst updateCampaignData = (message) => {\n    console.log('Update Campaign');\n    formData.value.campaignData = message;\n    console.log(formData);\n    console.log(props.modifyMode);\n    next();\n    };\n\nconst personaForm = ref(null);\nconst savePersonaForm = () => {\n    personaForm.value.createPersona();\n    }\nconst updatePersonaData = (message) => {\n    console.log('Update Persona');\n    formData.value.personaData = message;\n    console.log(formData);\n    next();\n    };\n\nconst productForm = ref(null);\nconst saveProductForm = () => {\n    productForm.value.createProduct();\n    }\nconst updateProductData = (message) => {\n    console.log('Update Product');\n    formData.value.productData = message;\n    console.log(formData);\n    next();\n    };\n\nconst senarioForm = ref(null);\nconst submitGuideForm = async() =>{\n    const token = localStorage.getItem('token');\n    const csrfToken= ref(getCsrfToken());\n    senarioForm.value.createSenario();\n    console.log('最终表单');\n    console.log(formData);\n    try{\n          const resp =  await axios.post('/api/assistant/',formData,{\n            headers: {\n                'Authorization': `Bearer ${token}`, // 设置请求头\n                'X-CSRFToken': csrfToken.value,\n                },\n            withCredentials: true,});\n          console.log(resp);\n         }catch (error) {\n        console.error('Failed to get info:', error);\n        }\n    }\nconst updateSenarioData = (message) => {\n    console.log('Update Senario');\n    formData.value.senarioData = message;\n    console.log(formData);\n    }\n\n</script>\n<style>\n.n-space{\n    margin:1.5em;}\n.n-card-header{\n    font-size:1.5em;\n    margin-left:1.2em;\n    margin-top:0.8em\n    }\n.n-card{\n    max-width:800px}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}