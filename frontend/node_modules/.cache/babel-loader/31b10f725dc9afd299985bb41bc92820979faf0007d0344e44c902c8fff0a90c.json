{"ast":null,"code":"import { createVNode as _createVNode, withCtx as _withCtx, createTextVNode as _createTextVNode, openBlock as _openBlock, createBlock as _createBlock } from \"vue\";\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createBlock($setup[\"NCard\"], null, {\n    default: _withCtx(() => [_createVNode($setup[\"NTabs\"], {\n      class: \"card-tabs\",\n      \"default-value\": \"signin\",\n      size: \"large\",\n      animated: \"\",\n      \"pane-wrapper-style\": \"margin: 0 -4px\",\n      \"pane-style\": \"padding-left: 4px; padding-right: 4px; box-sizing: border-box;\"\n    }, {\n      default: _withCtx(() => [_createVNode($setup[\"NTabPane\"], {\n        name: \"signin\",\n        tab: \"登录\"\n      }, {\n        default: _withCtx(() => [_createVNode($setup[\"NForm\"], null, {\n          default: _withCtx(() => [_createVNode($setup[\"NFormItemRow\"], {\n            label: \"用户名\"\n          }, {\n            default: _withCtx(() => [_createVNode($setup[\"NInput\"], {\n              value: $setup.loginUsername,\n              \"onUpdate:value\": _cache[0] || (_cache[0] = $event => $setup.loginUsername = $event),\n              placeholder: \"\"\n            }, null, 8 /* PROPS */, [\"value\"])]),\n            _: 1 /* STABLE */\n          }), _createVNode($setup[\"NFormItemRow\"], {\n            label: \"密码\"\n          }, {\n            default: _withCtx(() => [_createVNode($setup[\"NInput\"], {\n              value: $setup.loginPassword,\n              \"onUpdate:value\": _cache[1] || (_cache[1] = $event => $setup.loginPassword = $event),\n              placeholder: \"\",\n              type: \"password\",\n              \"show-password-on\": \"click\",\n              maxlength: 15\n            }, null, 8 /* PROPS */, [\"value\"])]),\n            _: 1 /* STABLE */\n          })]),\n          _: 1 /* STABLE */\n        }), _createVNode($setup[\"NButton\"], {\n          onClick: $setup.login,\n          type: \"primary\",\n          block: \"\",\n          secondary: \"\",\n          strong: \"\"\n        }, {\n          default: _withCtx(() => [_createTextVNode(\" 登录 \")]),\n          _: 1 /* STABLE */\n        })]),\n        _: 1 /* STABLE */\n      }), _createVNode($setup[\"NTabPane\"], {\n        name: \"signup\",\n        tab: \"注册\"\n      }, {\n        default: _withCtx(() => [_createVNode($setup[\"NForm\"], null, {\n          default: _withCtx(() => [_createVNode($setup[\"NFormItemRow\"], {\n            label: \"用户名\"\n          }, {\n            default: _withCtx(() => [_createVNode($setup[\"NInput\"], {\n              value: _ctx.registerUsername,\n              \"onUpdate:value\": _cache[2] || (_cache[2] = $event => _ctx.registerUsername = $event),\n              placeholder: \"\"\n            }, null, 8 /* PROPS */, [\"value\"])]),\n            _: 1 /* STABLE */\n          }), _createVNode($setup[\"NFormItemRow\"], {\n            label: \"密码\"\n          }, {\n            default: _withCtx(() => [_createVNode($setup[\"NInput\"], {\n              value: _ctx.registerPassword,\n              \"onUpdate:value\": _cache[3] || (_cache[3] = $event => _ctx.registerPassword = $event),\n              placeholder: \"\"\n            }, null, 8 /* PROPS */, [\"value\"])]),\n            _: 1 /* STABLE */\n          }), _createVNode($setup[\"NFormItemRow\"], {\n            label: \"重复密码\"\n          }, {\n            default: _withCtx(() => [_createVNode($setup[\"NInput\"], {\n              value: _ctx.registerRePassword,\n              \"onUpdate:value\": _cache[4] || (_cache[4] = $event => _ctx.registerRePassword = $event),\n              placeholder: \"\"\n            }, null, 8 /* PROPS */, [\"value\"])]),\n            _: 1 /* STABLE */\n          }), _createVNode($setup[\"NFormItemRow\"], {\n            label: \"邀请码\"\n          }, {\n            default: _withCtx(() => [_createVNode($setup[\"NInput\"], {\n              value: _ctx.invitation_code,\n              \"onUpdate:value\": _cache[5] || (_cache[5] = $event => _ctx.invitation_code = $event),\n              placeholder: \"\"\n            }, null, 8 /* PROPS */, [\"value\"])]),\n            _: 1 /* STABLE */\n          })]),\n          _: 1 /* STABLE */\n        }), _createVNode($setup[\"NButton\"], {\n          onClick: _ctx.register,\n          type: \"primary\",\n          block: \"\",\n          secondary: \"\",\n          strong: \"\"\n        }, {\n          default: _withCtx(() => [_createTextVNode(\" 注册 \")]),\n          _: 1 /* STABLE */\n        }, 8 /* PROPS */, [\"onClick\"])]),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    })]),\n    _: 1 /* STABLE */\n  });\n}","map":{"version":3,"names":["_createBlock","$setup","default","_withCtx","_createVNode","class","size","animated","name","tab","label","value","loginUsername","_cache","$event","placeholder","_","loginPassword","type","maxlength","onClick","login","block","secondary","strong","_createTextVNode","_ctx","registerUsername","registerPassword","registerRePassword","invitation_code","register"],"sources":["/Users/wangjohnson/ai_marketing/frontend/src/components/LoginForm.vue"],"sourcesContent":["<template>\n<n-card>\n    <n-tabs\n      class=\"card-tabs\"\n      default-value=\"signin\"\n      size=\"large\"\n      animated\n      pane-wrapper-style=\"margin: 0 -4px\"\n      pane-style=\"padding-left: 4px; padding-right: 4px; box-sizing: border-box;\"\n    >\n      <n-tab-pane name=\"signin\" tab=\"登录\">\n        <n-form>\n          <n-form-item-row label=\"用户名\">\n            <n-input v-model:value=\"loginUsername\" placeholder=\"\"/>\n          </n-form-item-row>\n          <n-form-item-row label=\"密码\">\n            <n-input v-model:value=\"loginPassword\" placeholder=\"\" type=\"password\" show-password-on=\"click\" :maxlength=\"15\"/>\n          </n-form-item-row>\n        </n-form>\n        <n-button @click=\"login\" type=\"primary\" block secondary strong>\n          登录\n        </n-button>\n      </n-tab-pane>\n\n      <n-tab-pane name=\"signup\" tab=\"注册\">\n        <n-form>\n          <n-form-item-row label=\"用户名\">\n            <n-input v-model:value=\"registerUsername\" placeholder=\"\" />\n          </n-form-item-row>\n          <n-form-item-row label=\"密码\">\n            <n-input v-model:value=\"registerPassword\" placeholder=\"\"/>\n          </n-form-item-row>\n          <n-form-item-row label=\"重复密码\">\n            <n-input v-model:value=\"registerRePassword\" placeholder=\"\"/>\n          </n-form-item-row>\n          <n-form-item-row label=\"邀请码\">\n            <n-input v-model:value=\"invitation_code\" placeholder=\"\"/>\n          </n-form-item-row>\n        </n-form>\n        <n-button @click=\"register\" type=\"primary\" block secondary strong>\n          注册\n        </n-button>\n      </n-tab-pane>\n    </n-tabs>\n  </n-card>\n</template>\n\n<script setup>\nimport {NButton,NInput,NForm,NFormItemRow,NCard,NTabs,NTabPane} from 'naive-ui'\nimport {ref,defineExpose} from 'vue';\nimport {useStore} from 'vuex';\nimport {useRouter} from 'vue-router';\nimport axios from 'axios';\n\n\n//通用变量\nconst authStore = useStore();\nconst router = useRouter();\n\n//登录表单操作\nconst loginUsername = ref('');\nconst loginPassword = ref('');\nconst keepLoggedInForDays = ref('7'); // 默认设置为7天，通过select控件让用户可选择\n\nconst login = async () => {\n    try{\n        const response = await axios.post('/account/login/', \n        {   \n          username: loginUsername.value,\n          password: loginPassword.value,\n          keep_logged_in_for_days: keepLoggedInForDays.value\n        },  \n        {   \n          withCredentials: true,\n          headers: {\n            //先注销'X-CSRFToken': csrfToken.value,\n          }   \n        });\n        const token = response.data.token.access;\n        const user = response.data.username;\n        const csrf_token = response.data.csrf_token;\n        console.log('csrf_token:',csrf_token);\n        localStorage.setItem('token', token);\n        await authStore.commit('auth_success', { token, user });\n        console.log(\"登录成功：\",loginUsername.value); \n        await router.push('/dashboard');\n        \n        }catch(err){\n            console.log(\"登录失败：\",err)\n        }\n    }\n\n\n\n//暴露方法\ndefineExpose({login});\n</script>\n\n<style>\n.n-input{\n    text-align:left}\n</style>\n\n"],"mappings":";;uBACAA,YAAA,CA2CWC,MAAA;IA5CXC,OAAA,EAAAC,QAAA,CAEI,MAyCS,CAzCTC,YAAA,CAyCSH,MAAA;MAxCPI,KAAK,EAAC,WAAW;MACjB,eAAa,EAAC,QAAQ;MACtBC,IAAI,EAAC,OAAO;MACZC,QAAQ,EAAR,EAAQ;MACR,oBAAkB,EAAC,gBAAgB;MACnC,YAAU,EAAC;;MARjBL,OAAA,EAAAC,QAAA,CAUM,MAYa,CAZbC,YAAA,CAYaH,MAAA;QAZDO,IAAI,EAAC,QAAQ;QAACC,GAAG,EAAC;;QAVpCP,OAAA,EAAAC,QAAA,CAWQ,MAOS,CAPTC,YAAA,CAOSH,MAAA;UAlBjBC,OAAA,EAAAC,QAAA,CAYU,MAEkB,CAFlBC,YAAA,CAEkBH,MAAA;YAFDS,KAAK,EAAC;UAAK;YAZtCR,OAAA,EAAAC,QAAA,CAaY,MAAuD,CAAvDC,YAAA,CAAuDH,MAAA;cAAtCU,KAAK,EAAEV,MAAA,CAAAW,aAAa;cAbjD,kBAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAaoCb,MAAA,CAAAW,aAAa,GAAAE,MAAA;cAAEC,WAAW,EAAC;;YAb/DC,CAAA;cAeUZ,YAAA,CAEkBH,MAAA;YAFDS,KAAK,EAAC;UAAI;YAfrCR,OAAA,EAAAC,QAAA,CAgBY,MAAgH,CAAhHC,YAAA,CAAgHH,MAAA;cAA/FU,KAAK,EAAEV,MAAA,CAAAgB,aAAa;cAhBjD,kBAAAJ,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAgBoCb,MAAA,CAAAgB,aAAa,GAAAH,MAAA;cAAEC,WAAW,EAAC,EAAE;cAACG,IAAI,EAAC,UAAU;cAAC,kBAAgB,EAAC,OAAO;cAAEC,SAAS,EAAE;;YAhBvHH,CAAA;;UAAAA,CAAA;YAmBQZ,YAAA,CAEWH,MAAA;UAFAmB,OAAK,EAAEnB,MAAA,CAAAoB,KAAK;UAAEH,IAAI,EAAC,SAAS;UAACI,KAAK,EAAL,EAAK;UAACC,SAAS,EAAT,EAAS;UAACC,MAAM,EAAN;;UAnBhEtB,OAAA,EAAAC,QAAA,CAmBuE,MAE/D,CArBRsB,gBAAA,CAmBuE,MAE/D,E;UArBRT,CAAA;;QAAAA,CAAA;UAwBMZ,YAAA,CAkBaH,MAAA;QAlBDO,IAAI,EAAC,QAAQ;QAACC,GAAG,EAAC;;QAxBpCP,OAAA,EAAAC,QAAA,CAyBQ,MAaS,CAbTC,YAAA,CAaSH,MAAA;UAtCjBC,OAAA,EAAAC,QAAA,CA0BU,MAEkB,CAFlBC,YAAA,CAEkBH,MAAA;YAFDS,KAAK,EAAC;UAAK;YA1BtCR,OAAA,EAAAC,QAAA,CA2BY,MAA2D,CAA3DC,YAAA,CAA2DH,MAAA;cAA1CU,KAAK,EAAEe,IAAA,CAAAC,gBAAgB;cA3BpD,kBAAAd,MAAA,QAAAA,MAAA,MAAAC,MAAA,IA2BoCY,IAAA,CAAAC,gBAAgB,GAAAb,MAAA;cAAEC,WAAW,EAAC;;YA3BlEC,CAAA;cA6BUZ,YAAA,CAEkBH,MAAA;YAFDS,KAAK,EAAC;UAAI;YA7BrCR,OAAA,EAAAC,QAAA,CA8BY,MAA0D,CAA1DC,YAAA,CAA0DH,MAAA;cAAzCU,KAAK,EAAEe,IAAA,CAAAE,gBAAgB;cA9BpD,kBAAAf,MAAA,QAAAA,MAAA,MAAAC,MAAA,IA8BoCY,IAAA,CAAAE,gBAAgB,GAAAd,MAAA;cAAEC,WAAW,EAAC;;YA9BlEC,CAAA;cAgCUZ,YAAA,CAEkBH,MAAA;YAFDS,KAAK,EAAC;UAAM;YAhCvCR,OAAA,EAAAC,QAAA,CAiCY,MAA4D,CAA5DC,YAAA,CAA4DH,MAAA;cAA3CU,KAAK,EAAEe,IAAA,CAAAG,kBAAkB;cAjCtD,kBAAAhB,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAiCoCY,IAAA,CAAAG,kBAAkB,GAAAf,MAAA;cAAEC,WAAW,EAAC;;YAjCpEC,CAAA;cAmCUZ,YAAA,CAEkBH,MAAA;YAFDS,KAAK,EAAC;UAAK;YAnCtCR,OAAA,EAAAC,QAAA,CAoCY,MAAyD,CAAzDC,YAAA,CAAyDH,MAAA;cAAxCU,KAAK,EAAEe,IAAA,CAAAI,eAAe;cApCnD,kBAAAjB,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAoCoCY,IAAA,CAAAI,eAAe,GAAAhB,MAAA;cAAEC,WAAW,EAAC;;YApCjEC,CAAA;;UAAAA,CAAA;YAuCQZ,YAAA,CAEWH,MAAA;UAFAmB,OAAK,EAAEM,IAAA,CAAAK,QAAQ;UAAEb,IAAI,EAAC,SAAS;UAACI,KAAK,EAAL,EAAK;UAACC,SAAS,EAAT,EAAS;UAACC,MAAM,EAAN;;UAvCnEtB,OAAA,EAAAC,QAAA,CAuC0E,MAElE,CAzCRsB,gBAAA,CAuC0E,MAElE,E;UAzCRT,CAAA;;QAAAA,CAAA;;MAAAA,CAAA;;IAAAA,CAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}