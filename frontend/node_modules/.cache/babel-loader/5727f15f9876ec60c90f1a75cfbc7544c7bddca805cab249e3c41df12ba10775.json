{"ast":null,"code":"import { isYesterday, addDays } from 'date-fns/esm';\nimport { NLayout, NLayoutSider, NLayoutContent, NLayoutHeader, NLayoutFooter, NCalendar, NCard } from 'naive-ui';\nimport { ref } from 'vue';\nimport axios from 'axios';\nimport { onBeforeMount } from 'vue';\nexport default {\n  __name: 'DashboardPage',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const userName = ref('');\n    const userInfo = ref({\n      username: '',\n      created_brands: '',\n      created_campaigns: '',\n      created_products: ''\n    });\n    //const message = useMessage();\n    const value = ref(addDays(Date.now(), 1).valueOf());\n    const handleUpdateValue = (_, {\n      year,\n      month,\n      date\n    }) => {\n      console.log(`${year}-${month}-${date}`);\n    };\n    const isDateDisabled = timestamp => {\n      if (isYesterday(timestamp)) {\n        return true;\n      }\n      return false;\n    };\n    const fetchUserInfo = async () => {\n      const token = localStorage.getItem('token');\n      console.log(token);\n      try {\n        const resp = await axios.get('/account/auth/', {\n          headers: {\n            'Authorization': `Bearer ${token}` // 设置请求头\n          }\n        });\n        console.log('验证结果:');\n        console.log(resp.data);\n        userInfo.value = resp.data;\n        userName.value = resp.data.username;\n        //has_brands.value = resp.data.created_brands.length;\n        localStorage.setItem('username', resp.data.username);\n      } catch (error) {\n        console.error('Failed to fetch user info:', error);\n      }\n    };\n    onBeforeMount(() => {\n      fetchUserInfo();\n    });\n    const __returned__ = {\n      userName,\n      userInfo,\n      value,\n      handleUpdateValue,\n      isDateDisabled,\n      fetchUserInfo,\n      get isYesterday() {\n        return isYesterday;\n      },\n      get addDays() {\n        return addDays;\n      },\n      get NLayout() {\n        return NLayout;\n      },\n      get NLayoutSider() {\n        return NLayoutSider;\n      },\n      get NLayoutContent() {\n        return NLayoutContent;\n      },\n      get NLayoutHeader() {\n        return NLayoutHeader;\n      },\n      get NLayoutFooter() {\n        return NLayoutFooter;\n      },\n      get NCalendar() {\n        return NCalendar;\n      },\n      get NCard() {\n        return NCard;\n      },\n      ref,\n      get axios() {\n        return axios;\n      },\n      onBeforeMount\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["isYesterday","addDays","NLayout","NLayoutSider","NLayoutContent","NLayoutHeader","NLayoutFooter","NCalendar","NCard","ref","axios","onBeforeMount","userName","userInfo","username","created_brands","created_campaigns","created_products","value","Date","now","valueOf","handleUpdateValue","_","year","month","date","console","log","isDateDisabled","timestamp","fetchUserInfo","token","localStorage","getItem","resp","get","headers","data","setItem","error"],"sources":["/Users/wangjohnson/ai_marketing/frontend/src/components/DashboardPage.vue"],"sourcesContent":["<template>\n<n-layout>\n  <n-layout-header>header</n-layout-header>\n  <n-layout has-sider>\n    <n-layout-content content-style=\"padding:24px\">\n\n      <n-card :bordered=\"false\" title=\"营销活动\" v-if=\"userInfo.created_campaigns\">\n        <n-card v-for=\"cam in userInfo.created_campaigns\" :key=\"cam.id || cam\" embedded>\n         dddd {{cam}}\n        </n-card>\n      </n-card>\n\n    \n    </n-layout-content>\n    <n-layout-sider :width=\"800\">\n      <n-card title=\"营销日历\" :bordered=\"false\">\n        <n-calendar v-model:value=\"value\" #=\"{ year, month, date }\" :is-date-disabled=\"isDateDisabled\" @update:value=\"handleUpdateValue\">\n        {{ year }}-{{ month }}-{{ date }}\n        </n-calendar>\n      </n-card>\n\n    </n-layout-sider>\n  </n-layout>\n  <n-layout-footer>footer</n-layout-footer>\n</n-layout>\n\n\n\n<n-card>\n{{userInfo.username}}\n\n</n-card>\n<n-card title=\"营销活动\" v-if=\"userInfo.created_campaigns\">\n    <n-card v-for=\"cam in userInfo.created_campaigns\" :key=\"cam.id || cam\" embedded>\n        {{cam}}\n    </n-card>\n</n-card>\n\n<n-card title=\"客户画像\" v-if=\"userInfo.created_personas\">\n {{userInfo.created_campaigns}}\n</n-card>\n\n<n-card title=\"品牌\" v-if=\"userInfo.created_brands\">\n {{userInfo.created_campaigns}}\n</n-card>\n\n<n-card title=\"产品或服务\" v-if=\"userInfo.created_products\">\n</n-card>\n</template>\n\n<script setup>\nimport { isYesterday, addDays } from 'date-fns/esm';\nimport {NLayout, NLayoutSider,NLayoutContent,NLayoutHeader,NLayoutFooter, NCalendar,NCard} from 'naive-ui';\nimport {ref} from 'vue';\nimport axios from 'axios';\n\nimport {onBeforeMount} from 'vue';\nconst userName = ref('');\nconst userInfo = ref({\n    username:'',\n    created_brands:'',\n    created_campaigns:'',\n    created_products:'',\n    });\n//const message = useMessage();\nconst value = ref(addDays(Date.now(), 1).valueOf());\nconst handleUpdateValue = (_, { year, month, date }) => {  \n  console.log(`${year}-${month}-${date}`);\n};\n\nconst isDateDisabled = (timestamp) => {\n    if (isYesterday(timestamp)) {\n          return true\n        }\n    return false\n    };\n\nconst fetchUserInfo = async() => {\n      const token = localStorage.getItem('token');\n      console.log(token);\n      try {\n        const resp =  await axios.get('/account/auth/',{\n            headers: {\n                'Authorization': `Bearer ${token}` // 设置请求头\n                }});\n        console.log('验证结果:')\n        console.log(resp.data);\n        userInfo.value = resp.data;\n        userName.value = resp.data.username;\n        //has_brands.value = resp.data.created_brands.length;\n        localStorage.setItem('username',resp.data.username);\n          } catch (error) {\n        console.error('Failed to fetch user info:', error);\n      }\n    };\n\nonBeforeMount(()=>{\n    fetchUserInfo();})\n\n</script>\n"],"mappings":"AAmDA,SAASA,WAAW,EAAEC,OAAO,QAAQ,cAAc;AACnD,SAAQC,OAAO,EAAEC,YAAY,EAACC,cAAc,EAACC,aAAa,EAACC,aAAa,EAAEC,SAAS,EAACC,KAAK,QAAO,UAAU;AAC1G,SAAQC,GAAG,QAAO,KAAK;AACvB,OAAOC,KAAK,MAAM,OAAO;AAEzB,SAAQC,aAAa,QAAO,KAAK;;;;;;;IACjC,MAAMC,QAAQ,GAAGH,GAAG,CAAC,EAAE,CAAC;IACxB,MAAMI,QAAQ,GAAGJ,GAAG,CAAC;MACjBK,QAAQ,EAAC,EAAE;MACXC,cAAc,EAAC,EAAE;MACjBC,iBAAiB,EAAC,EAAE;MACpBC,gBAAgB,EAAC;IACjB,CAAC,CAAC;IACN;IACA,MAAMC,KAAK,GAAGT,GAAG,CAACR,OAAO,CAACkB,IAAI,CAACC,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC,CAAC;IACnD,MAAMC,iBAAiB,GAAGA,CAACC,CAAC,EAAE;MAAEC,IAAI;MAAEC,KAAK;MAAEC;IAAK,CAAC,KAAK;MACtDC,OAAO,CAACC,GAAG,CAAE,GAAEJ,IAAK,IAAGC,KAAM,IAAGC,IAAK,EAAC,CAAC;IACzC,CAAC;IAED,MAAMG,cAAc,GAAIC,SAAS,IAAK;MAClC,IAAI9B,WAAW,CAAC8B,SAAS,CAAC,EAAE;QACtB,OAAO,IAAI;MACb;MACJ,OAAO,KAAK;IACZ,CAAC;IAEL,MAAMC,aAAa,GAAG,MAAAA,CAAA,KAAW;MAC3B,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;MAC3CP,OAAO,CAACC,GAAG,CAACI,KAAK,CAAC;MAClB,IAAI;QACF,MAAMG,IAAI,GAAI,MAAMzB,KAAK,CAAC0B,GAAG,CAAC,gBAAgB,EAAC;UAC3CC,OAAO,EAAE;YACL,eAAe,EAAG,UAASL,KAAM,EAAC,CAAC;UACnC;QAAC,CAAC,CAAC;QACXL,OAAO,CAACC,GAAG,CAAC,OAAO,CAAC;QACpBD,OAAO,CAACC,GAAG,CAACO,IAAI,CAACG,IAAI,CAAC;QACtBzB,QAAQ,CAACK,KAAK,GAAGiB,IAAI,CAACG,IAAI;QAC1B1B,QAAQ,CAACM,KAAK,GAAGiB,IAAI,CAACG,IAAI,CAACxB,QAAQ;QACnC;QACAmB,YAAY,CAACM,OAAO,CAAC,UAAU,EAACJ,IAAI,CAACG,IAAI,CAACxB,QAAQ,CAAC;MACjD,CAAC,CAAC,OAAO0B,KAAK,EAAE;QAClBb,OAAO,CAACa,KAAK,CAAC,4BAA4B,EAAEA,KAAK,CAAC;MACpD;IACF,CAAC;IAEL7B,aAAa,CAAC,MAAI;MACdoB,aAAa,CAAC,CAAC;IAAC,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}