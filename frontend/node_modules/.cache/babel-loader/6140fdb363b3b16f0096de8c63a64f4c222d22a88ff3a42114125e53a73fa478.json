{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, createCommentVNode as _createCommentVNode, withModifiers as _withModifiers, withKeys as _withKeys, createTextVNode as _createTextVNode, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nexport function render(_ctx, _cache) {\n  const _component_n_input = _resolveComponent(\"n-input\");\n  const _component_n_form_item_row = _resolveComponent(\"n-form-item-row\");\n  const _component_n_form_item = _resolveComponent(\"n-form-item\");\n  const _component_n_form = _resolveComponent(\"n-form\");\n  const _component_n_button = _resolveComponent(\"n-button\");\n  return _openBlock(), _createElementBlock(_Fragment, null, [_createVNode(_component_n_form, {\n    ref: \"formRef\",\n    rules: _ctx.rules,\n    model: _ctx.modelRef\n  }, {\n    default: _withCtx(() => [_createVNode(_component_n_form_item_row, {\n      label: \"用户名\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_n_input, {\n        value: _ctx.registerUsername,\n        \"onUpdate:value\": _cache[0] || (_cache[0] = $event => _ctx.registerUsername = $event),\n        placeholder: \"\"\n      }, null, 8 /* PROPS */, [\"value\"])]),\n      _: 1 /* STABLE */\n    }), _createCommentVNode(\"\\n        <n-form-item-row label=\\\"密码\\\" :feedback=\\\"validateInfos.password>\\n            <n-input v-model:value=\\\"registerPassword\\\" placeholder=\\\"\\\"/>\\n        </n-form-item-row>\\n          \\n        <n-form-item-row label=\\\"重复密码\\\">\\n            //<n-input passively-activated @input=\\\"checkRePassword\\\" v-model:value=\\\"rePassword\\\" placeholder=\\\"\\\"/>\\n            <n-input\\n                v-model:value=\\\"rePassword\\\"\\n                :disabled=\\\"!model.password\\\"\\n                type=\\\"password\\\"\\n                @keydown.enter.prevent/>\\n        </n-form-item-row>\\n         \"), _createCommentVNode(\"验证模块\"), _createVNode(_component_n_form_item, {\n      path: \"password\",\n      label: \"密码\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_n_input, {\n        value: _ctx.modelRef.password,\n        \"onUpdate:value\": _cache[1] || (_cache[1] = $event => _ctx.modelRef.password = $event),\n        type: \"password\",\n        onInput: _ctx.handlePasswordInput,\n        onKeydown: _cache[2] || (_cache[2] = _withKeys(_withModifiers(() => {}, [\"prevent\"]), [\"enter\"]))\n      }, null, 8 /* PROPS */, [\"value\", \"onInput\"])]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_n_form_item, {\n      ref: \"rPasswordFormItemRef\",\n      first: \"\",\n      path: \"reenteredPassword\",\n      label: \"重复密码\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_n_input, {\n        value: _ctx.modelRef.reenteredPassword,\n        \"onUpdate:value\": _cache[3] || (_cache[3] = $event => _ctx.modelRef.reenteredPassword = $event),\n        disabled: !_ctx.modelRef.password,\n        type: \"password\",\n        onKeydown: _cache[4] || (_cache[4] = _withKeys(_withModifiers(() => {}, [\"prevent\"]), [\"enter\"]))\n      }, null, 8 /* PROPS */, [\"value\", \"disabled\"])]),\n      _: 1 /* STABLE */\n    }, 512 /* NEED_PATCH */), _createVNode(_component_n_form_item_row, {\n      label: \"邀请码\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_n_input, {\n        value: _ctx.invitation_code,\n        \"onUpdate:value\": _cache[5] || (_cache[5] = $event => _ctx.invitation_code = $event),\n        placeholder: \"\"\n      }, null, 8 /* PROPS */, [\"value\"])]),\n      _: 1 /* STABLE */\n    })]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"rules\", \"model\"]), _createVNode(_component_n_button, {\n    onClick: _ctx.register,\n    type: \"primary\",\n    block: \"\",\n    secondary: \"\",\n    strong: \"\"\n  }, {\n    default: _withCtx(() => [_createTextVNode(\" 注册 \")]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"onClick\"]), _createElementVNode(\"pre\", null, _toDisplayString(JSON.stringify(_ctx.modelRef, null, 2)) + \"\\n\", 1 /* TEXT */)], 64 /* STABLE_FRAGMENT */);\n}","map":{"version":3,"names":["_createElementBlock","_Fragment","_createVNode","_component_n_form","ref","rules","_ctx","model","modelRef","default","_withCtx","_component_n_form_item_row","label","_component_n_input","value","registerUsername","_cache","$event","placeholder","_","_createCommentVNode","_component_n_form_item","path","password","type","onInput","handlePasswordInput","onKeydown","_withKeys","_withModifiers","first","reenteredPassword","disabled","invitation_code","_component_n_button","onClick","register","block","secondary","strong","_createTextVNode","_createElementVNode","_toDisplayString","JSON","stringify"],"sources":["/Users/wangjohnson/ai_marketing/frontend/src/components/RegisterForm.vue"],"sourcesContent":["<template>\n    <n-form ref=\"formRef\" :rules=\"rules\"  :model=\"modelRef\">\n        <n-form-item-row label=\"用户名\">\n            <n-input v-model:value=\"registerUsername\" placeholder=\"\" />\n        </n-form-item-row>\n        \n        <!--\n        <n-form-item-row label=\"密码\" :feedback=\"validateInfos.password>\n            <n-input v-model:value=\"registerPassword\" placeholder=\"\"/>\n        </n-form-item-row>\n          \n        <n-form-item-row label=\"重复密码\">\n            //<n-input passively-activated @input=\"checkRePassword\" v-model:value=\"rePassword\" placeholder=\"\"/>\n            <n-input\n                v-model:value=\"rePassword\"\n                :disabled=\"!model.password\"\n                type=\"password\"\n                @keydown.enter.prevent/>\n        </n-form-item-row>\n         -->\n         \n         \n         <!--验证模块-->\n\n        <n-form-item path=\"password\" label=\"密码\">\n          <n-input\n            v-model:value=\"modelRef.password\"\n            type=\"password\"\n            @input=\"handlePasswordInput\"\n            @keydown.enter.prevent/>\n        </n-form-item>\n    \n        <n-form-item\n          ref=\"rPasswordFormItemRef\"\n          first\n          path=\"reenteredPassword\"\n          label=\"重复密码\">\n\n          <n-input\n            v-model:value=\"modelRef.reenteredPassword\"\n            :disabled=\"!modelRef.password\"\n            type=\"password\"\n            @keydown.enter.prevent/>\n\n        </n-form-item>\n\n\n\n\n\n\n        <n-form-item-row label=\"邀请码\">\n            <n-input v-model:value=\"invitation_code\" placeholder=\"\"/>\n        </n-form-item-row>\n        \n    </n-form>\n    <n-button @click=\"register\" type=\"primary\" block secondary strong>\n          注册\n    </n-button>\n\n<pre>{{ JSON.stringify(modelRef, null, 2) }}\n</pre>\n</template>\n\n\n<script setup>\nimport {NFormItem,NFormItemRow,NForm,NButton,NInput} from 'naive-ui';\nimport {ref,defineExpose} from 'vue';\nimport {useRoute} from 'vue-router';\nimport axios from 'axios';\n\n//注册表单操作\nconst registerUsername=ref('');\nconst registerPassword=ref('');\n//const registerRePassword=ref('');\nconst invitationCode = ref('');\nconst router=useRoute();\nconst registeredNextPath = ref('');\n\nconst register=async()=>{\n    try{\n      const response = axios.post('/account/register/',\n      {\n        username:registerUsername,\n        password:registerPassword,\n        invitation_code:invitationCode,\n        },\n      {\n            headers:{\n                //'X-CSRFToken': csrfToken.value,\n                }\n      });\n      console.log(response);\n      console.log('注册成功！');\n      await router.push(registeredNextPath.value);\n    }\n    catch(err){\n        console.log('注册失败:',err)}\n    \n }\n\n//密码验证\n/*\nconst formRef = ref(null);\n\nconst model = ref({\n      password: '',\n      reenteredPassword: ''\n    });\n\nconst validatePasswordStartWith=(rule, value)=> {\n      console.log(value);\n      return !!model.value.password && model.value.password.startsWith(value) && model.value.password.length >= value.length;};\nconst validatePasswordSame=(rule, value)=> {\n      console.log(value);\n      return value === model.value.password;\n    };\nconst rules = {\n    password: [\n        {\n          required: true,\n          message: \"请输入密码\"\n        }\n      ],\n      reenteredPassword: [\n        {\n          required: true,\n          message: \"请再次输入密码\",\n          trigger: [\"input\", \"blur\"]\n        },\n        {\n          validator: validatePasswordStartWith,\n          message: \"两次密码输入不一致\",\n          trigger: \"input\"\n        },\n        {\n          validator: validatePasswordSame,\n          message: \"两次密码输入不一致\",\n          trigger: [\"blur\", \"input\"]\n        }\n      ]\n    };\nconst handlePasswordInput=()=> {\n        if (model.value.reenteredPassword) {\n          rPasswordFormItemRef.value?.validate({ trigger: \"input\" });\n        }\n      };\n\n*/\n\nconst formRef = ref(null);\nconst rPasswordFormItemRef = ref(null);\n\n// 响应式表单数据\nconst modelRef = ref({\n  password: '',\n  reenteredPassword: '',\n});\n\n//表单验证规则\nconst rules = {\n  password: [\n    {\n      required: true,\n      message: \"请输入密码\",\n      trigger:[\"blur\",\"input\"]\n    }\n  ],\n  reenteredPassword: [\n    {\n      required: true,\n      message: \"请再次输入密码\",\n      trigger: [\"input\", \"blur\"]\n    },\n    \n    {\n      validator: validatePasswordSame,\n      message: \"两次密码输入不一致\",\n      trigger: [\"blur\", \"input\"]\n    }\n  ]\n};\n\n\n\nfunction validatePasswordSame(rule, value) {\n  try{\n  return value === modelRef.value.password;\n  }catch(err){\n      console.log(err)}\n  \n  }\n\n\n\nconst handlePasswordInput=()=> {\n  if (modelRef.value.reenteredPassword) {\n\n      try {\n      await rPasswordFormItemRef.value.validate();\n    } catch (error) {\n      console.error('Validation error:', error);\n    }\n    //rPasswordFormItemRef.value?.validate({ trigger: \"input\" });\n  }\n}\n\n\ndefineExpose({register});\n</script>\n\n<style>\n.n-input{\n    text-align:left}\n</style>\n"],"mappings":";;;;;;;uBAAAA,mBAAA,CAAAC,SAAA,SACIC,YAAA,CAsDSC,iBAAA;IAtDDC,GAAG,EAAC,SAAS;IAAEC,KAAK,EAAEC,IAAA,CAAAD,KAAK;IAAIE,KAAK,EAAED,IAAA,CAAAE;;IADlDC,OAAA,EAAAC,QAAA,CAEQ,MAEkB,CAFlBR,YAAA,CAEkBS,0BAAA;MAFDC,KAAK,EAAC;IAAK;MAFpCH,OAAA,EAAAC,QAAA,CAGY,MAA2D,CAA3DR,YAAA,CAA2DW,kBAAA;QAA1CC,KAAK,EAAER,IAAA,CAAAS,gBAAgB;QAHpD,kBAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAGoCX,IAAA,CAAAS,gBAAgB,GAAAE,MAAA;QAAEC,WAAW,EAAC;;MAHlEC,CAAA;QAMQC,mBAAA,2kBAaI,EAGHA,mBAAA,QAAW,EAEZlB,YAAA,CAMcmB,sBAAA;MANDC,IAAI,EAAC,UAAU;MAACV,KAAK,EAAC;;MAxB3CH,OAAA,EAAAC,QAAA,CAyBU,MAI0B,CAJ1BR,YAAA,CAI0BW,kBAAA;QAHhBC,KAAK,EAAER,IAAA,CAAAE,QAAQ,CAACe,QAAQ;QA1B5C,kBAAAP,MAAA,QAAAA,MAAA,MAAAC,MAAA,IA0B2BX,IAAA,CAAAE,QAAQ,CAACe,QAAQ,GAAAN,MAAA;QAChCO,IAAI,EAAC,UAAU;QACdC,OAAK,EAAEnB,IAAA,CAAAoB,mBAAmB;QAC1BC,SAAO,EAAAX,MAAA,QAAAA,MAAA,MA7BpBY,SAAA,CAAAC,cAAA,CA6BY,QAAsB;;MA7BlCV,CAAA;QAgCQjB,YAAA,CAYcmB,sBAAA;MAXZjB,GAAG,EAAC,sBAAsB;MAC1B0B,KAAK,EAAL,EAAK;MACLR,IAAI,EAAC,mBAAmB;MACxBV,KAAK,EAAC;;MApChBH,OAAA,EAAAC,QAAA,CAsCU,MAI0B,CAJ1BR,YAAA,CAI0BW,kBAAA;QAHhBC,KAAK,EAAER,IAAA,CAAAE,QAAQ,CAACuB,iBAAiB;QAvCrD,kBAAAf,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAuC2BX,IAAA,CAAAE,QAAQ,CAACuB,iBAAiB,GAAAd,MAAA;QACxCe,QAAQ,GAAG1B,IAAA,CAAAE,QAAQ,CAACe,QAAQ;QAC7BC,IAAI,EAAC,UAAU;QACdG,SAAO,EAAAX,MAAA,QAAAA,MAAA,MA1CpBY,SAAA,CAAAC,cAAA,CA0CY,QAAsB;;MA1ClCV,CAAA;8BAmDQjB,YAAA,CAEkBS,0BAAA;MAFDC,KAAK,EAAC;IAAK;MAnDpCH,OAAA,EAAAC,QAAA,CAoDY,MAAyD,CAAzDR,YAAA,CAAyDW,kBAAA;QAAxCC,KAAK,EAAER,IAAA,CAAA2B,eAAe;QApDnD,kBAAAjB,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAoDoCX,IAAA,CAAA2B,eAAe,GAAAhB,MAAA;QAAEC,WAAW,EAAC;;MApDjEC,CAAA;;IAAAA,CAAA;yCAwDIjB,YAAA,CAEWgC,mBAAA;IAFAC,OAAK,EAAE7B,IAAA,CAAA8B,QAAQ;IAAEZ,IAAI,EAAC,SAAS;IAACa,KAAK,EAAL,EAAK;IAACC,SAAS,EAAT,EAAS;IAACC,MAAM,EAAN;;IAxD/D9B,OAAA,EAAAC,QAAA,CAwDsE,MAElE,CA1DJ8B,gBAAA,CAwDsE,MAElE,E;IA1DJrB,CAAA;kCA4DAsB,mBAAA,CACM,aAAAC,gBAAA,CADEC,IAAI,CAACC,SAAS,CAACtC,IAAA,CAAAE,QAAQ,cAAa,IAC5C,gB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}