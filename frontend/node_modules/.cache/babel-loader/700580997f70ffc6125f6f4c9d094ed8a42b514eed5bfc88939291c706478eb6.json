{"ast":null,"code":"import { isYesterday, addDays } from 'date-fns/esm';\nimport { NCalendar } from 'naive-ui';\nimport { ref } from 'vue';\nimport axios from 'axios';\nimport { onBeforeMount } from 'vue';\nexport default {\n  __name: 'DashboardPage',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const userName = ref('');\n    const userInfo = ref(null);\n    //const message = useMessage();\n    const value = ref(addDays(Date.now(), 1).valueOf());\n    const handleUpdateValue = (_, {\n      year,\n      month,\n      date\n    }) => {\n      console.log(`${year}-${month}-${date}`);\n    };\n    const isDateDisabled = timestamp => {\n      if (isYesterday(timestamp)) {\n        return true;\n      }\n      return false;\n    };\n    const fetchUserInfo = async () => {\n      const token = localStorage.getItem('token');\n      console.log(token);\n      try {\n        const resp = await axios.get('/account/auth/', {\n          headers: {\n            'Authorization': `Bearer ${token}` // 设置请求头\n          }\n        });\n        console.log('验证结果:');\n        console.log(resp.data);\n        userInfo.value = resp.data;\n        userName.value = resp.data.username;\n        //has_brands.value = resp.data.created_brands.length;\n        localStorage.setItem('username', resp.data.username);\n      } catch (error) {\n        console.error('Failed to fetch user info:', error);\n      }\n    };\n    onBeforeMount(async () => {\n      fetchUserInfo();\n    });\n    const __returned__ = {\n      userName,\n      userInfo,\n      value,\n      handleUpdateValue,\n      isDateDisabled,\n      fetchUserInfo,\n      get isYesterday() {\n        return isYesterday;\n      },\n      get addDays() {\n        return addDays;\n      },\n      get NCalendar() {\n        return NCalendar;\n      },\n      ref,\n      get axios() {\n        return axios;\n      },\n      onBeforeMount\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["isYesterday","addDays","NCalendar","ref","axios","onBeforeMount","userName","userInfo","value","Date","now","valueOf","handleUpdateValue","_","year","month","date","console","log","isDateDisabled","timestamp","fetchUserInfo","token","localStorage","getItem","resp","get","headers","data","username","setItem","error"],"sources":["/Users/wangjohnson/ai_marketing/frontend/src/components/DashboardPage.vue"],"sourcesContent":["<template>\n<n-card title=\"userInfo.username\"></n-card>\n<n-card v-if=\"userInfo.created_campaigns\">\n {{userInfo.created_campaigns}}\n({userInfo.username}}\n</n-card>\n\n<n-calendar\n    v-model:value=\"value\"\n    #=\"{ year, month, date }\"\n    :is-date-disabled=\"isDateDisabled\"\n    @update:value=\"handleUpdateValue\"\n  >\n    {{ year }}-{{ month }}-{{ date }}\n  </n-calendar>\n\n</template>\n\n<script setup>\nimport { isYesterday, addDays } from 'date-fns/esm';\nimport {NCalendar} from 'naive-ui';\nimport {ref} from 'vue';\nimport axios from 'axios';\n\nimport {onBeforeMount} from 'vue';\nconst userName = ref('');\nconst userInfo = ref(null);\n//const message = useMessage();\nconst value = ref(addDays(Date.now(), 1).valueOf());\nconst handleUpdateValue = (_, { year, month, date }) => {  \n  console.log(`${year}-${month}-${date}`);\n};\n\nconst isDateDisabled = (timestamp) => {\n    if (isYesterday(timestamp)) {\n          return true\n        }\n    return false\n    };\n\nconst fetchUserInfo = async() => {\n      const token = localStorage.getItem('token');\n      console.log(token);\n      try {\n        const resp =  await axios.get('/account/auth/',{\n            headers: {\n                'Authorization': `Bearer ${token}` // 设置请求头\n                }});\n        console.log('验证结果:')\n        console.log(resp.data);\n        userInfo.value = resp.data;\n        userName.value = resp.data.username;\n        //has_brands.value = resp.data.created_brands.length;\n        localStorage.setItem('username',resp.data.username);\n          } catch (error) {\n        console.error('Failed to fetch user info:', error);\n      }\n    };\n\nonBeforeMount(async()=>{\n    fetchUserInfo();})\n\n</script>\n"],"mappings":"AAmBA,SAASA,WAAW,EAAEC,OAAO,QAAQ,cAAc;AACnD,SAAQC,SAAS,QAAO,UAAU;AAClC,SAAQC,GAAG,QAAO,KAAK;AACvB,OAAOC,KAAK,MAAM,OAAO;AAEzB,SAAQC,aAAa,QAAO,KAAK;;;;;;;IACjC,MAAMC,QAAQ,GAAGH,GAAG,CAAC,EAAE,CAAC;IACxB,MAAMI,QAAQ,GAAGJ,GAAG,CAAC,IAAI,CAAC;IAC1B;IACA,MAAMK,KAAK,GAAGL,GAAG,CAACF,OAAO,CAACQ,IAAI,CAACC,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC,CAAC;IACnD,MAAMC,iBAAiB,GAAGA,CAACC,CAAC,EAAE;MAAEC,IAAI;MAAEC,KAAK;MAAEC;IAAK,CAAC,KAAK;MACtDC,OAAO,CAACC,GAAG,CAAE,GAAEJ,IAAK,IAAGC,KAAM,IAAGC,IAAK,EAAC,CAAC;IACzC,CAAC;IAED,MAAMG,cAAc,GAAIC,SAAS,IAAK;MAClC,IAAIpB,WAAW,CAACoB,SAAS,CAAC,EAAE;QACtB,OAAO,IAAI;MACb;MACJ,OAAO,KAAK;IACZ,CAAC;IAEL,MAAMC,aAAa,GAAG,MAAAA,CAAA,KAAW;MAC3B,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;MAC3CP,OAAO,CAACC,GAAG,CAACI,KAAK,CAAC;MAClB,IAAI;QACF,MAAMG,IAAI,GAAI,MAAMrB,KAAK,CAACsB,GAAG,CAAC,gBAAgB,EAAC;UAC3CC,OAAO,EAAE;YACL,eAAe,EAAG,UAASL,KAAM,EAAC,CAAC;UACnC;QAAC,CAAC,CAAC;QACXL,OAAO,CAACC,GAAG,CAAC,OAAO,CAAC;QACpBD,OAAO,CAACC,GAAG,CAACO,IAAI,CAACG,IAAI,CAAC;QACtBrB,QAAQ,CAACC,KAAK,GAAGiB,IAAI,CAACG,IAAI;QAC1BtB,QAAQ,CAACE,KAAK,GAAGiB,IAAI,CAACG,IAAI,CAACC,QAAQ;QACnC;QACAN,YAAY,CAACO,OAAO,CAAC,UAAU,EAACL,IAAI,CAACG,IAAI,CAACC,QAAQ,CAAC;MACjD,CAAC,CAAC,OAAOE,KAAK,EAAE;QAClBd,OAAO,CAACc,KAAK,CAAC,4BAA4B,EAAEA,KAAK,CAAC;MACpD;IACF,CAAC;IAEL1B,aAAa,CAAC,YAAS;MACnBgB,aAAa,CAAC,CAAC;IAAC,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}