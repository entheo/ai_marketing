{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, createTextVNode as _createTextVNode, openBlock as _openBlock, createBlock as _createBlock } from \"vue\";\nexport function render(_ctx, _cache) {\n  const _component_n_input = _resolveComponent(\"n-input\");\n  const _component_n_form_item_row = _resolveComponent(\"n-form-item-row\");\n  const _component_n_form = _resolveComponent(\"n-form\");\n  const _component_n_button = _resolveComponent(\"n-button\");\n  const _component_n_tab_pane = _resolveComponent(\"n-tab-pane\");\n  const _component_n_tabs = _resolveComponent(\"n-tabs\");\n  const _component_n_card = _resolveComponent(\"n-card\");\n  return _openBlock(), _createBlock(_component_n_card, null, {\n    default: _withCtx(() => [_createVNode(_component_n_tabs, {\n      class: \"card-tabs\",\n      \"default-value\": \"signin\",\n      size: \"large\",\n      animated: \"\",\n      \"pane-wrapper-style\": \"margin: 0 -4px\",\n      \"pane-style\": \"padding-left: 4px; padding-right: 4px; box-sizing: border-box;\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_n_tab_pane, {\n        name: \"signin\",\n        tab: \"登录\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_n_form, null, {\n          default: _withCtx(() => [_createVNode(_component_n_form_item_row, {\n            label: \"用户名\"\n          }, {\n            default: _withCtx(() => [_createVNode(_component_n_input)]),\n            _: 1 /* STABLE */\n          }), _createVNode(_component_n_form_item_row, {\n            label: \"密码\"\n          }, {\n            default: _withCtx(() => [_createVNode(_component_n_input)]),\n            _: 1 /* STABLE */\n          })]),\n          _: 1 /* STABLE */\n        }), _createVNode(_component_n_button, {\n          onClick: _ctx.login,\n          type: \"primary\",\n          block: \"\",\n          secondary: \"\",\n          strong: \"\"\n        }, {\n          default: _withCtx(() => [_createTextVNode(\" 登录 \")]),\n          _: 1 /* STABLE */\n        }, 8 /* PROPS */, [\"onClick\"])]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_n_tab_pane, {\n        name: \"signup\",\n        tab: \"注册\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_n_form, null, {\n          default: _withCtx(() => [_createVNode(_component_n_form_item_row, {\n            label: \"用户名\"\n          }, {\n            default: _withCtx(() => [_createVNode(_component_n_input)]),\n            _: 1 /* STABLE */\n          }), _createVNode(_component_n_form_item_row, {\n            label: \"密码\"\n          }, {\n            default: _withCtx(() => [_createVNode(_component_n_input)]),\n            _: 1 /* STABLE */\n          }), _createVNode(_component_n_form_item_row, {\n            label: \"重复密码\"\n          }, {\n            default: _withCtx(() => [_createVNode(_component_n_input)]),\n            _: 1 /* STABLE */\n          })]),\n          _: 1 /* STABLE */\n        }), _createVNode(_component_n_button, {\n          onClick: _ctx.register,\n          type: \"primary\",\n          block: \"\",\n          secondary: \"\",\n          strong: \"\"\n        }, {\n          default: _withCtx(() => [_createTextVNode(\" 注册 \")]),\n          _: 1 /* STABLE */\n        }, 8 /* PROPS */, [\"onClick\"])]),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    })]),\n    _: 1 /* STABLE */\n  });\n}","map":{"version":3,"names":["_createBlock","_component_n_card","default","_withCtx","_createVNode","_component_n_tabs","class","size","animated","_component_n_tab_pane","name","tab","_component_n_form","_component_n_form_item_row","label","_component_n_input","_","_component_n_button","onClick","_ctx","login","type","block","secondary","strong","_createTextVNode","register"],"sources":["/Users/wangjohnson/ai_marketing/frontend/src/components/LoginForm.vue"],"sourcesContent":["<template>\n<n-card>\n    <n-tabs\n      class=\"card-tabs\"\n      default-value=\"signin\"\n      size=\"large\"\n      animated\n      pane-wrapper-style=\"margin: 0 -4px\"\n      pane-style=\"padding-left: 4px; padding-right: 4px; box-sizing: border-box;\"\n    >\n      <n-tab-pane name=\"signin\" tab=\"登录\">\n        <n-form>\n          <n-form-item-row label=\"用户名\">\n            <n-input />\n          </n-form-item-row>\n          <n-form-item-row label=\"密码\">\n            <n-input />\n          </n-form-item-row>\n        </n-form>\n        <n-button @click=\"login\" type=\"primary\" block secondary strong>\n          登录\n        </n-button>\n      </n-tab-pane>\n      <n-tab-pane name=\"signup\" tab=\"注册\">\n        <n-form>\n          <n-form-item-row label=\"用户名\">\n            <n-input />\n          </n-form-item-row>\n          <n-form-item-row label=\"密码\">\n            <n-input />\n          </n-form-item-row>\n          <n-form-item-row label=\"重复密码\">\n            <n-input />\n          </n-form-item-row>\n        </n-form>\n        <n-button @click=\"register\" type=\"primary\" block secondary strong>\n          注册\n        </n-button>\n      </n-tab-pane>\n    </n-tabs>\n  </n-card>\n</template>\n\n<script setup>\nimport {NButton,NIput,NForm,NFormItemRow,NCard,NTabs,NTabPane} from 'naive-ui'\nimport {ref,defineExpose} from 'vue';\nimport {useStore} from 'vuex';\nimport {useRouter} from 'vue-router';\n\n\n//通用变量\nconst authStore = useStore();\nconst router = useRouter();\n\n//登录表单操作\nconst loginUsername = ref('');\nconst loginPassword = ref('');\nconst keepLoggedInForDays = ref('7'); // 默认设置为7天，通过select控件让用户可选择\n\nconst login = async () => {\n    await axios.post('/account/login/', \n      {\n        username: loginUsername.value,\n        password: loginPassword.value,\n        keep_logged_in_for_days: keepLoggedInForDays.value\n      },\n      {\n        withCredentials: true,\n        headers: {\n            //先注销'X-CSRFToken': csrfToken.value,\n          }\n      }).then(resp=>{\n            console.log(\"登录成功，用户名: \", loginUsername.value);\n            const token = response.data.token.access;\n            const user = response.data.username;\n            const csrf_token = response.data.csrf_token;\n            console.log('csrf_token:');\n            console.log(csrf_token);\n            localStorage.setItem('token', token);\n            await authStore.commit('auth_success', { token, user });\n            await router.push('/dashboard');\n        }).catch(err=>{\n            console.log('登录失败：',err);\n            });\n    };\n\n\n//暴露方法\ndefineExpose({login});\n</script>\n\n"],"mappings":";;;;;;;;;uBACAA,YAAA,CAuCWC,iBAAA;IAxCXC,OAAA,EAAAC,QAAA,CAEI,MAqCS,CArCTC,YAAA,CAqCSC,iBAAA;MApCPC,KAAK,EAAC,WAAW;MACjB,eAAa,EAAC,QAAQ;MACtBC,IAAI,EAAC,OAAO;MACZC,QAAQ,EAAR,EAAQ;MACR,oBAAkB,EAAC,gBAAgB;MACnC,YAAU,EAAC;;MARjBN,OAAA,EAAAC,QAAA,CAUM,MAYa,CAZbC,YAAA,CAYaK,qBAAA;QAZDC,IAAI,EAAC,QAAQ;QAACC,GAAG,EAAC;;QAVpCT,OAAA,EAAAC,QAAA,CAWQ,MAOS,CAPTC,YAAA,CAOSQ,iBAAA;UAlBjBV,OAAA,EAAAC,QAAA,CAYU,MAEkB,CAFlBC,YAAA,CAEkBS,0BAAA;YAFDC,KAAK,EAAC;UAAK;YAZtCZ,OAAA,EAAAC,QAAA,CAaY,MAAW,CAAXC,YAAA,CAAWW,kBAAA,E;YAbvBC,CAAA;cAeUZ,YAAA,CAEkBS,0BAAA;YAFDC,KAAK,EAAC;UAAI;YAfrCZ,OAAA,EAAAC,QAAA,CAgBY,MAAW,CAAXC,YAAA,CAAWW,kBAAA,E;YAhBvBC,CAAA;;UAAAA,CAAA;YAmBQZ,YAAA,CAEWa,mBAAA;UAFAC,OAAK,EAAEC,IAAA,CAAAC,KAAK;UAAEC,IAAI,EAAC,SAAS;UAACC,KAAK,EAAL,EAAK;UAACC,SAAS,EAAT,EAAS;UAACC,MAAM,EAAN;;UAnBhEtB,OAAA,EAAAC,QAAA,CAmBuE,MAE/D,CArBRsB,gBAAA,CAmBuE,MAE/D,E;UArBRT,CAAA;;QAAAA,CAAA;UAuBMZ,YAAA,CAeaK,qBAAA;QAfDC,IAAI,EAAC,QAAQ;QAACC,GAAG,EAAC;;QAvBpCT,OAAA,EAAAC,QAAA,CAwBQ,MAUS,CAVTC,YAAA,CAUSQ,iBAAA;UAlCjBV,OAAA,EAAAC,QAAA,CAyBU,MAEkB,CAFlBC,YAAA,CAEkBS,0BAAA;YAFDC,KAAK,EAAC;UAAK;YAzBtCZ,OAAA,EAAAC,QAAA,CA0BY,MAAW,CAAXC,YAAA,CAAWW,kBAAA,E;YA1BvBC,CAAA;cA4BUZ,YAAA,CAEkBS,0BAAA;YAFDC,KAAK,EAAC;UAAI;YA5BrCZ,OAAA,EAAAC,QAAA,CA6BY,MAAW,CAAXC,YAAA,CAAWW,kBAAA,E;YA7BvBC,CAAA;cA+BUZ,YAAA,CAEkBS,0BAAA;YAFDC,KAAK,EAAC;UAAM;YA/BvCZ,OAAA,EAAAC,QAAA,CAgCY,MAAW,CAAXC,YAAA,CAAWW,kBAAA,E;YAhCvBC,CAAA;;UAAAA,CAAA;YAmCQZ,YAAA,CAEWa,mBAAA;UAFAC,OAAK,EAAEC,IAAA,CAAAO,QAAQ;UAAEL,IAAI,EAAC,SAAS;UAACC,KAAK,EAAL,EAAK;UAACC,SAAS,EAAT,EAAS;UAACC,MAAM,EAAN;;UAnCnEtB,OAAA,EAAAC,QAAA,CAmC0E,MAElE,CArCRsB,gBAAA,CAmC0E,MAElE,E;UArCRT,CAAA;;QAAAA,CAAA;;MAAAA,CAAA;;IAAAA,CAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}