{"ast":null,"code":"import { NDatePicker, NButton, NForm, NCard, NInput, NH5, NSelect, NDrawer } from 'naive-ui';\nimport { onBeforeMount } from 'vue';\nimport axios from 'axios';\nimport { ref } from 'vue';\nimport CreateCampaignForm from './CreateCampaignForm.vue';\nexport default {\n  __name: 'CampaignPage',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const getCsrfToken = () => {\n      let csrfToken = null;\n      if (document.cookie && document.cookie !== '') {\n        const cookies = document.cookie.split(';');\n        for (let i = 0; i < cookies.length; i++) {\n          const cookie = cookies[i].trim();\n          if (cookie.startsWith('csrftoken=')) {\n            csrfToken = decodeURIComponent(cookie.substring('csrftoken='.length));\n            break;\n          }\n        }\n      }\n      return csrfToken;\n    };\n    const csrfToken = ref(getCsrfToken());\n    const campaignForm = ref(null);\n    const campaignFormData = ref({});\n    const submitCampaignForm = () => {\n      campaignForm.value.createCampaign();\n    };\n    const handleCampaignInfo = message => {\n      console.log(message);\n      /*\n               axios.post('http://localhost:8005/api/response/', formData)\n                 .then(resp => {\n                   // 处理你后端返回的response\n                   console.log(resp);\n                   message.value = resp.data.message;\n                 })\n                 .catch(err => {\n                   console.log(err);\n                 });\n                 \n          */\n    };\n    const userName = ref('');\n    const fetchUserInfo = async () => {\n      const token = localStorage.getItem('token');\n      console.log(token);\n      try {\n        const resp = await axios.get('/account/auth/', {\n          headers: {\n            'Authorization': `Bearer ${token}` // 设置请求头\n          }\n        });\n        console.log('验证结果:');\n        console.log(resp.data);\n        userName.value = resp.data.username;\n        has_brands.value = resp.data.created_brands.length;\n        //localStorage.setItem('username',resp.data.username);\n      } catch (error) {\n        console.error('Failed to fetch user info:', error);\n      }\n    };\n    onBeforeMount(async () => {\n      fetchUserInfo();\n    });\n    const __returned__ = {\n      getCsrfToken,\n      csrfToken,\n      campaignForm,\n      campaignFormData,\n      submitCampaignForm,\n      handleCampaignInfo,\n      userName,\n      fetchUserInfo,\n      get NDatePicker() {\n        return NDatePicker;\n      },\n      get NButton() {\n        return NButton;\n      },\n      get NForm() {\n        return NForm;\n      },\n      get NCard() {\n        return NCard;\n      },\n      get NInput() {\n        return NInput;\n      },\n      get NH5() {\n        return NH5;\n      },\n      get NSelect() {\n        return NSelect;\n      },\n      get NDrawer() {\n        return NDrawer;\n      },\n      onBeforeMount,\n      get axios() {\n        return axios;\n      },\n      ref,\n      CreateCampaignForm\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["NDatePicker","NButton","NForm","NCard","NInput","NH5","NSelect","NDrawer","onBeforeMount","axios","ref","CreateCampaignForm","getCsrfToken","csrfToken","document","cookie","cookies","split","i","length","trim","startsWith","decodeURIComponent","substring","campaignForm","campaignFormData","submitCampaignForm","value","createCampaign","handleCampaignInfo","message","console","log","userName","fetchUserInfo","token","localStorage","getItem","resp","get","headers","data","username","has_brands","created_brands","error"],"sources":["/Users/wangjohnson/ai_marketing/frontend/src/components/CampaignPage.vue"],"sourcesContent":["<template>\n<div class=\"page-container\" style=\"height: 100vh; overflow: hidden;text-align:left\">\n    \n    <n-card>\n     <create-campaign-form @createCampaignInfo=\"handleCampaignInfo\" ref=\"campaignForm\"/> \n    </n-card>\n</div>\n\n\n\n</template>\n<script setup>\n  import { NDatePicker, NButton, NForm, NCard, NInput, NH5, NSelect, NDrawer} from 'naive-ui';\n  import {onBeforeMount} from 'vue'; \n  import axios from 'axios';\n  import { ref } from 'vue';   \n  import CreateCampaignForm from './CreateCampaignForm.vue';\n\n  const getCsrfToken = () => {\n    let csrfToken = null;\n    if (document.cookie && document.cookie !== '') {\n      const cookies = document.cookie.split(';');\n      for (let i = 0; i < cookies.length; i++) {\n        const cookie = cookies[i].trim();\n        if (cookie.startsWith('csrftoken=')) {\n            csrfToken = decodeURIComponent(cookie.substring('csrftoken='.length));\n            break;\n        }   \n      }   \n    }   \n    return csrfToken;\n  };\n  const csrfToken = ref(getCsrfToken());\n  \n\n  const campaignForm = ref(null);\n  const campaignFormData = ref({});\n  const submitCampaignForm = () => {\n      campaignForm.value.createCampaign();\n      }\n\n  const handleCampaignInfo = (message) => {\n      console.log(message);\n      /*\n               axios.post('http://localhost:8005/api/response/', formData)\n                 .then(resp => {\n                   // 处理你后端返回的response\n                   console.log(resp);\n                   message.value = resp.data.message;\n                 })\n                 .catch(err => {\n                   console.log(err);\n                 });\n                 \n          */ };\n\n\n  const userName = ref('');\n  const fetchUserInfo = async() => {\n      const token = localStorage.getItem('token');\n      console.log(token);\n      try {\n        const resp =  await axios.get('/account/auth/',{\n            headers: {\n                'Authorization': `Bearer ${token}` // 设置请求头\n                }});\n        console.log('验证结果:')\n        console.log(resp.data);\n        userName.value = resp.data.username;\n        has_brands.value = resp.data.created_brands.length;\n        //localStorage.setItem('username',resp.data.username);\n          } catch (error) {\n        console.error('Failed to fetch user info:', error);\n      }\n    };\n    \nonBeforeMount(async()=>{\n    fetchUserInfo();\n    })\n</script>\n\n<style>\n.tricks {\n    font-size:0.8em;\n}\n</style>\n"],"mappings":"AAYE,SAASA,WAAW,EAAEC,OAAO,EAAEC,KAAK,EAAEC,KAAK,EAAEC,MAAM,EAAEC,GAAG,EAAEC,OAAO,EAAEC,OAAO,QAAO,UAAU;AAC3F,SAAQC,aAAa,QAAO,KAAK;AACjC,OAAOC,KAAK,MAAM,OAAO;AACzB,SAASC,GAAG,QAAQ,KAAK;AACzB,OAAOC,kBAAkB,MAAM,0BAA0B;;;;;;;IAEzD,MAAMC,YAAY,GAAGA,CAAA,KAAM;MACzB,IAAIC,SAAS,GAAG,IAAI;MACpB,IAAIC,QAAQ,CAACC,MAAM,IAAID,QAAQ,CAACC,MAAM,KAAK,EAAE,EAAE;QAC7C,MAAMC,OAAO,GAAGF,QAAQ,CAACC,MAAM,CAACE,KAAK,CAAC,GAAG,CAAC;QAC1C,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGF,OAAO,CAACG,MAAM,EAAED,CAAC,EAAE,EAAE;UACvC,MAAMH,MAAM,GAAGC,OAAO,CAACE,CAAC,CAAC,CAACE,IAAI,CAAC,CAAC;UAChC,IAAIL,MAAM,CAACM,UAAU,CAAC,YAAY,CAAC,EAAE;YACjCR,SAAS,GAAGS,kBAAkB,CAACP,MAAM,CAACQ,SAAS,CAAC,YAAY,CAACJ,MAAM,CAAC,CAAC;YACrE;UACJ;QACF;MACF;MACA,OAAON,SAAS;IAClB,CAAC;IACD,MAAMA,SAAS,GAAGH,GAAG,CAACE,YAAY,CAAC,CAAC,CAAC;IAGrC,MAAMY,YAAY,GAAGd,GAAG,CAAC,IAAI,CAAC;IAC9B,MAAMe,gBAAgB,GAAGf,GAAG,CAAC,CAAC,CAAC,CAAC;IAChC,MAAMgB,kBAAkB,GAAGA,CAAA,KAAM;MAC7BF,YAAY,CAACG,KAAK,CAACC,cAAc,CAAC,CAAC;IACnC,CAAC;IAEL,MAAMC,kBAAkB,GAAIC,OAAO,IAAK;MACpCC,OAAO,CAACC,GAAG,CAACF,OAAO,CAAC;MACpB;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;IAAa,CAAC;IAGZ,MAAMG,QAAQ,GAAGvB,GAAG,CAAC,EAAE,CAAC;IACxB,MAAMwB,aAAa,GAAG,MAAAA,CAAA,KAAW;MAC7B,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;MAC3CN,OAAO,CAACC,GAAG,CAACG,KAAK,CAAC;MAClB,IAAI;QACF,MAAMG,IAAI,GAAI,MAAM7B,KAAK,CAAC8B,GAAG,CAAC,gBAAgB,EAAC;UAC3CC,OAAO,EAAE;YACL,eAAe,EAAG,UAASL,KAAM,EAAC,CAAC;UACnC;QAAC,CAAC,CAAC;QACXJ,OAAO,CAACC,GAAG,CAAC,OAAO,CAAC;QACpBD,OAAO,CAACC,GAAG,CAACM,IAAI,CAACG,IAAI,CAAC;QACtBR,QAAQ,CAACN,KAAK,GAAGW,IAAI,CAACG,IAAI,CAACC,QAAQ;QACnCC,UAAU,CAAChB,KAAK,GAAGW,IAAI,CAACG,IAAI,CAACG,cAAc,CAACzB,MAAM;QAClD;MACE,CAAC,CAAC,OAAO0B,KAAK,EAAE;QAClBd,OAAO,CAACc,KAAK,CAAC,4BAA4B,EAAEA,KAAK,CAAC;MACpD;IACF,CAAC;IAELrC,aAAa,CAAC,YAAS;MACnB0B,aAAa,CAAC,CAAC;IACf,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}